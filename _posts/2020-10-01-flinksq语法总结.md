> [https://support.huaweicloud.com/sqlref-flink-dli/dli_08_0207.html](https://support.huaweicloud.com/sqlref-flink-dli/dli_08_0207.html)
> ​

​

​

​

#### 复杂数据类型

##### MAP

##### ARRAY

##### ROW

```
Row 一组命名的字段,字段类型可以不同

如: ROW<a1 TYPE1, a2 TYPE2>
构造方式 Row('1',2) as v1
应用方式 变量名.字段名   例如 v1.a1


create source t_name (
	id string,
  type sttring,
  addr Row(province string, city string, state string),
  person Row(age int, sex boolean, name string)
)
```

over partition 的底层原理

```

deduplication 算子
  depulication算子为每一个partition key维护了一个value state, 用于去重。
  每来一条数据时从当前partition key的value state取获取value, 如果不为空, 说明已经有数据来过了,
  当前这一条数据就是重复数据, 就不往下游算子下发了, 如果为空, 说明之前有数据来过, 当前这一条数据就是
  就是第一条数据, 则把当前的value state值设置为ture, 往下游算子下发数据。
```

```
select [column_list]
 FROM
   (
     select [column_list],
            row_number() over ([Partition By col1[,clo2]] order by time_attr_col [asc|desc]) as rownum
     from table_name
   ) where row_num = 1;
```
