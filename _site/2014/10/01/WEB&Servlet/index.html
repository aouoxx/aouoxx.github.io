<!DOCTYPE html><html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /><title>web&Servlet的基础信息介绍 &mdash; ssgao</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/vendor/primer-css/css/primer.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/css/components/collection.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/css/components/repo-card.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/css/sections/repo-list.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/css/components/boxed-group.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/css/globals/common.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/css/globals/responsive.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/css/posts/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mzlogin/rouge-themes@master/dist/github.css"><link rel="canonical" href="http://localhost:4000/2014/10/01/WEB&Servlet/"><link rel="alternate" type="application/atom+xml" title="ssgao" href="http://localhost:4000/feed.xml"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/favicon.ico"><meta property="og:title" content="web&Servlet的基础信息介绍"><meta name="keywords" content="web, servlet"><meta name="og:keywords" content="web, servlet"><meta name="description" content="​"><meta name="og:description" content="​"><meta property="og:url" content="http://localhost:4000/2014/10/01/WEB&Servlet/"><meta property="og:site_name" content="ssgao"><meta property="og:type" content="article"><meta property="og:locale" content="zh_CN" /><meta property="article:published_time" content="2014-10-01"> <script src="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/js/jquery-ui.js"></script> <script src="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/js/main.js"></script></head><body class="" data-mz=""><header class="site-header"><div class="container"><h1><a href="http://localhost:4000/" title="ssgao"><span class="octicon octicon-mark-github"></span> ssgao</a></h1><button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><nav class="site-header-nav" role="navigation"> <a href="http://localhost:4000/" class=" site-header-nav-item" target="" title="首页">首页</a> <a href="http://localhost:4000/categories/" class=" site-header-nav-item" target="" title="分类">分类</a> <a href="http://localhost:4000/links/" class=" site-header-nav-item" target="" title="链接">链接</a> <a href="http://localhost:4000/about/" class=" site-header-nav-item" target="" title="关于">关于</a></nav></div></header><section class="collection-head small geopattern" data-pattern-id="web&Servlet的基础信"><div class="container"><div class="columns"><div class="column three-fourths"><div class="collection-title"><h1 class="collection-header">web&Servlet的基础信息介绍</h1><div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2014/10/01 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="http://localhost:4000/categories/#web" title="web">web</a> </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="http://localhost:4000/categories/#servlet" title="servlet">servlet</a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> 共 34679 字，约 100 分钟 </span></div></div></div><div class="column one-fourth mobile-hidden"><div class="collection-title"> <img style="height:72px;width:72px" src="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/images/qrcode.jpg" alt="ssgao断点" /></div></div></div></div></section><section class="container content"><div class="columns"><div class="column three-fourths" ><article class="article-content markdown-body"><meta name="referrer" content="no-referrer" /><p>​</p><p>ccc</p><h3 id="welcome-file-list">welcome-file-list</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">当用户在浏览中输入的UTL不包含某个servlet</span> <span class="n">名或JSP页面的时候</span><span class="err">，</span><span class="n">welecome</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="n">list元素可以指定默认的文件</span><span class="err">。</span><span class="n">一般用于默认登陆页面</span>

  <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="n">list</span> <span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="n">index</span><span class="o">.</span><span class="na">html</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="n">index</span><span class="o">.</span><span class="na">htm</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="n">index</span><span class="o">.</span><span class="na">jsp</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="k">default</span><span class="o">.</span><span class="na">html</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="k">default</span><span class="o">.</span><span class="na">htm</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="k">default</span><span class="o">.</span><span class="na">jsp</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="n">list</span> <span class="o">&gt;</span>

<span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="n">list的工作原理是</span><span class="err">：</span><span class="n">按照welcome</span><span class="o">-</span><span class="n">file的</span> <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span><span class="n">一个一个的去检查是否web目录下面有这个文件</span><span class="err">，</span><span class="n">如果不存在</span><span class="err">，</span><span class="n">继续向下查找</span><span class="err">。</span>
<span class="n">若存在跳转到对应的页面</span><span class="err">。</span>
<span class="n">welcome</span><span class="o">-</span><span class="n">file不可以是一个直接访问的action</span><span class="err">（</span><span class="n">直接跳转到对应的urlpattern</span><span class="err">），</span><span class="n">解决的方法就是通过url跳转或jsp的forward跳转到action地址就可以了</span><span class="err">。</span>

<span class="o">&lt;?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span> <span class="s">"1.0"</span> <span class="n">encoding</span> <span class="o">=</span><span class="s">"UTF-8"</span><span class="o">?&gt;</span>
<span class="o">&lt;</span><span class="n">web</span><span class="o">-</span><span class="n">app</span> <span class="nl">xmlns:</span><span class="n">xsi</span><span class="o">=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="n">xmlns</span><span class="o">=</span><span class="s">"http://java.sun.com/xml/ns/javaee"</span>
  <span class="nl">xsi:</span><span class="n">schemaLocation</span><span class="o">=</span> <span class="s">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span> <span class="n">id</span><span class="o">=</span> <span class="s">"WebApp_ID"</span> <span class="n">version</span> <span class="o">=</span><span class="s">"3.0"</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">display</span><span class="o">-</span><span class="n">name</span> <span class="o">&gt;</span><span class="nc">Servlet</span><span class="o">&lt;/</span><span class="n">display</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="n">list</span> <span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="n">index</span><span class="o">.</span><span class="na">html</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="n">index</span><span class="o">.</span><span class="na">htm</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="n">index</span><span class="o">.</span><span class="na">jsp</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="k">default</span><span class="o">.</span><span class="na">html</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="k">default</span><span class="o">.</span><span class="na">htm</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span> <span class="o">&gt;</span><span class="k">default</span><span class="o">.</span><span class="na">jsp</span> <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">welcome</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="n">list</span> <span class="o">&gt;</span>
<span class="o">&lt;/</span> <span class="n">web</span><span class="o">-</span><span class="n">app</span><span class="o">&gt;</span>




</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635735274195-54db8535-d745-4032-85e7-b1d34f41de70.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=173&amp;id=udaae8d92&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=267&amp;originWidth=1189&amp;originalType=binary&amp;ratio=1&amp;size=23120&amp;status=done&amp;style=none&amp;taskId=u270ad6e8-7350-4987-925d-53e1f46ece7&amp;width=770.5" alt="image.png" /></p><blockquote><p><em>访问页面：http://127.0.0.1/Servlet/</em></p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635735307992-8b33862c-168b-48dd-81f5-0e13518ab9c4.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=136&amp;id=ufc9eaf2f&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=207&amp;originWidth=1180&amp;originalType=binary&amp;ratio=1&amp;size=16065&amp;status=done&amp;style=none&amp;taskId=u554bbb8a-bdff-4431-a48e-32141ba2da1&amp;width=776" alt="image.png" /> ​</p><p>​</p><h3 id="errorpage-页面跳转">errorpage 页面跳转</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">首先需要在Web</span><span class="o">.</span><span class="na">xml文件中配置如下标签</span><span class="err">：</span>
  <span class="o">&lt;</span><span class="n">error</span><span class="o">-</span><span class="n">page</span> <span class="o">&gt;</span>
       <span class="o">&lt;</span><span class="n">error</span><span class="o">-</span><span class="n">code</span> <span class="o">&gt;</span><span class="mi">404</span> <span class="o">&lt;/</span><span class="n">error</span><span class="o">-</span><span class="n">code</span><span class="o">&gt;</span>
       <span class="o">&lt;</span><span class="n">location</span> <span class="o">&gt;/</span><span class="n">error</span><span class="o">.</span><span class="na">html</span> <span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">error</span><span class="o">-</span><span class="n">page</span> <span class="o">&gt;</span>

<span class="n">error</span><span class="o">-</span><span class="n">code</span> <span class="n">是错误代码</span><span class="o">,</span><span class="n">location</span> <span class="n">是转向页面</span><span class="err">。</span>
<span class="n">如果这个配置成功</span><span class="err">，</span><span class="n">当服务器出现这个错误代码的时候就会跳转到location这个页面</span><span class="err">。</span>
<span class="n">location可以是html文件也可以是jsp页面</span><span class="err">。</span>

<span class="n">如果Tomcat配置完成后</span><span class="err">：</span>
</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635736020281-e59b8ec1-2d2f-4ec1-ae2a-0aeb21e5f387.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=449&amp;id=u79432b1f&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=727&amp;originWidth=1336&amp;originalType=binary&amp;ratio=1&amp;size=151073&amp;status=done&amp;style=none&amp;taskId=ub23d8ff9-4500-4bd4-b85e-2e95b90b424&amp;width=825" alt="image.png" /></p><blockquote><p><em>当访问在当前该 web 服务下一个不存在的页面时,就会跳转到对应的错误处理页面,如果访问的不是当前服务下的页面的时候是不会跳转的( 这一点对 form 表单提交的时候尤其需要注意不要顺便定义)</em></p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635736082250-935644eb-86df-4bff-966f-13250388375e.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=185&amp;id=u8ddc2591&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=275&amp;originWidth=1193&amp;originalType=binary&amp;ratio=1&amp;size=23991&amp;status=done&amp;style=none&amp;taskId=ue29a2dd7-77b6-43e6-b079-9a67753e456&amp;width=802.5" alt="image.png" /></p><blockquote><p><em>访问当前服务下不存在的页面</em></p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635736106987-ffdc0e09-9600-414c-883b-f6f322314795.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=128&amp;id=uaa994c45&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=188&amp;originWidth=1181&amp;originalType=binary&amp;ratio=1&amp;size=21298&amp;status=done&amp;style=none&amp;taskId=ua1bfbef2-4ed2-47c6-b64e-d0f190d9b37&amp;width=805.5" alt="image.png" /></p><blockquote><p><em>访问的不是当前服务下的页面：http://127.0.0.1/accociat</em></p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635736134293-f20da321-fc92-40fd-b8d6-b2ddcad05048.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=137&amp;id=uaae267d4&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=225&amp;originWidth=1309&amp;originalType=binary&amp;ratio=1&amp;size=24733&amp;status=done&amp;style=none&amp;taskId=u085f9caf-7493-4de7-9f29-0658f34c7ea&amp;width=797.5" alt="image.png" /> ​</p><h3 id="urlpattern-的匹配">urlpattern 的匹配</h3><h4 id="urlpattern-的匹配原则">urlpattern 的匹配原则</h4><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="err">）</span> <span class="n">完全匹配</span>
          <span class="n">以</span><span class="err">“</span><span class="o">/</span><span class="err">”</span><span class="n">开头</span><span class="err">，</span><span class="n">以字母</span><span class="err">（</span><span class="n">非</span><span class="err">“</span><span class="o">*</span><span class="err">”）</span><span class="n">结束</span> <span class="n">如</span><span class="err">：</span><span class="o">&lt;</span><span class="n">url</span><span class="o">-</span><span class="n">pattern</span><span class="o">&gt;/</span><span class="n">test</span><span class="o">/</span><span class="n">list</span><span class="o">.</span><span class="na">do</span><span class="o">&lt;/</span><span class="n">url</span><span class="o">-</span><span class="n">pattern</span><span class="o">&gt;</span>
<span class="mi">2</span><span class="o">)</span> <span class="n">目录匹配</span>
          <span class="n">以</span><span class="err">“</span><span class="o">/</span><span class="err">”</span><span class="n">开头且以</span><span class="err">“</span><span class="o">/*</span><span class="err">”</span><span class="n">结尾</span> <span class="n">如</span><span class="err">：</span><span class="o">&lt;</span><span class="n">url</span><span class="o">-</span><span class="n">pattern</span><span class="o">&gt;/</span><span class="n">test</span><span class="o">/*&lt;/</span><span class="n">url</span><span class="o">-</span><span class="n">pattern</span><span class="o">&gt;</span>
<span class="mi">3</span><span class="o">)</span> <span class="n">扩展名匹配</span>
          <span class="n">以</span><span class="o">*</span> <span class="n">开头</span><span class="err">，</span><span class="n">以扩展名结束</span>  <span class="n">如</span><span class="o">&lt;</span><span class="n">url</span><span class="o">-</span><span class="n">pattern</span><span class="o">&gt;*.</span><span class="na">do</span><span class="o">&lt;/</span><span class="n">url</span><span class="o">-</span><span class="n">pattern</span><span class="o">&gt;</span>
<span class="mi">4</span><span class="o">)</span> <span class="n">用</span><span class="err">“</span><span class="o">/</span><span class="err">”</span><span class="n">来表明对应的Servlet为应用默认的Servlet</span>
    <span class="n">这种情况下Serlvet路径是请求的URL去掉上下文路径并且路径信息为NULL</span>

<span class="n">匹配过程</span><span class="err">：</span>
     <span class="n">当一个请求发送到Servlet容器的时候</span><span class="err">，</span>
     <span class="n">容器先将请求的URL减去当前应用上下文的路径作为Servlet的映射Url</span><span class="o">,</span>
     <span class="nl">例如我访问的是http:</span><span class="c1">//localhost/test/aaa.html我的应用上下就是test（Web的程序名称）</span>
</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635735410684-7a122e67-0cd7-438e-b9b9-7f1bdb029a05.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=137&amp;id=u41a4117d&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=203&amp;originWidth=1174&amp;originalType=binary&amp;ratio=1&amp;size=20040&amp;status=done&amp;style=none&amp;taskId=u5862bcc5-76c8-4e7f-98e0-f0df33d1744&amp;width=793" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">Tomcat</span> <span class="n">可以通过Service</span><span class="o">&gt;&gt;</span><span class="nc">Model进行上下文的配置</span><span class="err">，</span><span class="n">例如我将我的应用程序名设为Servlet</span><span class="err">，</span><span class="n">对应的path为</span><span class="err">“</span><span class="o">/</span><span class="err">”，</span><span class="n">我的应用上下文就是空的</span><span class="err">，</span><span class="n">如果将path设置为Serlvet我的应用上下文为Servlet</span><span class="err">，</span><span class="nc">Path的</span>
     <span class="n">设置为影响页面中Servlet</span> <span class="n">urlPattern的验证路径</span>
     <span class="n">path</span><span class="o">=/</span>   <span class="nd">@WebServlet</span> <span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"annociation"</span><span class="o">,</span><span class="n">urlPatterns</span><span class="o">=</span> <span class="s">"/annociation/*"</span> <span class="o">)</span>  <span class="nl">Servlet中对应的路径应该为http:</span><span class="c1">//127.0.0.1/annociation/*</span>
     <span class="n">path</span><span class="o">=/</span><span class="nc">Servlet</span>  <span class="nd">@WebServlet</span> <span class="o">(</span><span class="n">name</span><span class="o">=</span> <span class="s">"annociation"</span><span class="o">,</span><span class="n">urlPatterns</span><span class="o">=</span> <span class="s">"/annociation/*"</span> <span class="o">)</span>  <span class="nl">Servlet中对应的路径应该为http:</span><span class="c1">//127.0.0.1/Servlet/annociation/*</span>

<span class="n">如下form表单的提交路径为</span> <span class="nl">http:</span><span class="c1">//127.0.0.1:8081/annocation?test=xx; （ip+端口号+urlpattern）</span>
     <span class="n">如果将Servlet对应的Tomcat中将path调整</span><span class="err">，</span><span class="n">但是urlPattern不变</span><span class="err">，</span><span class="n">form表单提交的时候需要action</span><span class="o">=</span><span class="n">path</span><span class="o">/+</span><span class="n">提交路径</span>
<span class="no">A</span><span class="o">)</span>
     <span class="mi">1</span><span class="o">)</span> <span class="n">path</span><span class="o">=/</span>
     <span class="mi">2</span><span class="err">）</span><span class="n">页面提交路径</span><span class="err">：</span>
          <span class="o">&lt;!</span><span class="no">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
               <span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
               <span class="o">&lt;</span><span class="n">meta</span> <span class="n">charset</span><span class="o">=</span> <span class="s">"UTF-8"</span><span class="o">&gt;</span>
               <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span> <span class="nc">Insert</span> <span class="n">title</span> <span class="n">here</span><span class="o">&lt;/</span><span class="n">title</span> <span class="o">&gt;</span>
               <span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
               <span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span> <span class="s">"/annociation"</span> <span class="n">method</span> <span class="o">=</span><span class="s">"get"</span><span class="o">&gt;</span>
                  <span class="o">&lt;</span><span class="n">input</span>  <span class="n">type</span><span class="o">=</span> <span class="s">"text"</span>  <span class="n">name</span> <span class="o">=</span><span class="s">"test"</span><span class="o">/&gt;</span>
                          <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span> <span class="s">"submit"</span> <span class="n">value</span> <span class="o">=</span><span class="s">"提交"</span><span class="o">&gt;</span>
               <span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
          <span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
          <span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
     <span class="mi">3</span><span class="o">)</span> <span class="nc">Servlet</span> <span class="nl">UrlPattern:</span>
           <span class="nd">@WebServlet</span> <span class="o">(</span><span class="n">name</span><span class="o">=</span> <span class="s">"annociation"</span><span class="o">,</span><span class="n">urlPatterns</span><span class="o">=</span> <span class="s">"/annociation/*"</span> <span class="o">)</span>
</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635735459683-f62b5ba4-cf7c-4d09-b524-c6a685d43ce5.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=120&amp;id=ufa0a437c&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=203&amp;originWidth=1355&amp;originalType=binary&amp;ratio=1&amp;size=20248&amp;status=done&amp;style=none&amp;taskId=uc6006a3c-bde8-40d7-bd65-3887735f580&amp;width=799.5" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">B</span><span class="o">)</span>
  <span class="mi">1</span><span class="o">)</span> <span class="nc">Path</span><span class="o">=/</span><span class="nc">Servlet</span>
  <span class="mi">2</span><span class="o">)</span> <span class="n">页面提交路径</span><span class="err">：</span>
     <span class="o">&lt;!</span><span class="no">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">meta</span> <span class="n">charset</span><span class="o">=</span> <span class="s">"UTF-8"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span> <span class="nc">Insert</span> <span class="n">title</span> <span class="n">here</span><span class="o">&lt;/</span><span class="n">title</span> <span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
             <span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span> <span class="s">"/Servlet/annociation"</span> <span class="n">method</span> <span class="o">=</span><span class="s">"get"</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">input</span>  <span class="n">type</span><span class="o">=</span> <span class="s">"text"</span>  <span class="n">name</span> <span class="o">=</span><span class="s">"test"</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span> <span class="s">"submit"</span> <span class="n">value</span> <span class="o">=</span><span class="s">"提交"</span><span class="o">&gt;</span>
             <span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
             <span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
   <span class="mi">3</span><span class="o">)</span> <span class="nc">Servlet</span> <span class="nl">UrlPattern:</span>
     <span class="nd">@WebServlet</span> <span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"annociation"</span><span class="o">,</span><span class="n">urlPatterns</span><span class="o">=</span> <span class="s">"/annociation/*"</span> <span class="o">)</span>

</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635735517470-37ab7aed-b0b6-4066-bff3-8b1e784411d4.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=122&amp;id=uf71b852b&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=207&amp;originWidth=1352&amp;originalType=binary&amp;ratio=1&amp;size=20356&amp;status=done&amp;style=none&amp;taskId=u2b3d847d-79e5-497b-845c-3be1a0d37d3&amp;width=795" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">由于客户端是通过URL地址访问web服务器中的资源</span><span class="err">，</span><span class="n">所以Servlet程序若想被外界访问</span><span class="err">，</span><span class="n">必须把servlet程序映射到一个URL地址上</span><span class="err">，</span>
 <span class="n">这个工作</span><span class="err">，</span><span class="n">在web</span><span class="o">.</span><span class="na">xml文件中使用</span><span class="o">&lt;</span><span class="n">servlet</span><span class="o">&gt;</span><span class="n">元素和</span><span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">mapping</span><span class="o">&gt;</span><span class="n">元素完成</span><span class="err">。</span>

<span class="n">一个</span><span class="o">&lt;</span><span class="nc">Servlet</span><span class="o">-</span><span class="n">mapping</span><span class="o">&gt;</span><span class="n">元素用于映射一个已经注册的Servlet的一个对外访问的路径</span><span class="err">，</span>
	<span class="n">它包含两个子元素</span><span class="err">，</span><span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="n">和</span><span class="o">&lt;</span><span class="n">url</span><span class="o">-</span><span class="n">pattern</span><span class="o">&gt;</span><span class="n">分别用于指定servlet的注册名称和</span>


<span class="n">servlet的对外访问路径</span><span class="err">。</span>
	<span class="n">同一个Serlvet可以被映射到多个URL上</span><span class="err">，</span>
    <span class="n">即多个</span><span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">mapping</span><span class="o">&gt;</span><span class="n">元素的</span><span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="n">子元素的设置值可以是同一个Servlet注册名</span>
<span class="n">在Servlet映射到的URL中也可以使用</span><span class="o">*</span><span class="n">通配符</span><span class="err">，</span>
	<span class="n">但是只能有两种固定的格式</span><span class="err">：</span>
    		<span class="n">一种格式是</span><span class="s">"*.扩展名"</span>
    		<span class="n">一种格式是以正斜杠</span><span class="err">（</span><span class="o">/</span><span class="err">）</span><span class="n">开头并以</span><span class="s">"/*"</span><span class="n">结尾</span><span class="err">。</span>
</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635735901686-c132e699-be8d-4f41-beef-4550796dcaec.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=151&amp;id=u60c88dc4&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=302&amp;originWidth=1752&amp;originalType=binary&amp;ratio=1&amp;size=154278&amp;status=done&amp;style=none&amp;taskId=u5397575e-1828-42c7-b98f-b370228cf7e&amp;width=876" alt="image.png" /></p><blockquote><p><em>*匹配任意的字符，所以可以使用任意的 URL 去访问 ServletDemo01 这个 Servlet</em></p></blockquote><p><strong><em>映射关系的对应</em></strong>​ <img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635735833638-147f0ad0-eb00-4430-94c4-45fae2c2016b.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=226&amp;id=u0b24d2e7&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=452&amp;originWidth=1742&amp;originalType=binary&amp;ratio=1&amp;size=311270&amp;status=done&amp;style=none&amp;taskId=u5135fa1b-2d75-4c45-8d18-9c8eb9e80f0&amp;width=871" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">缺省的Servlet</span><span class="err">，</span><span class="nc">UrlPattern</span> <span class="s">"/"</span>
    <span class="n">如果某个Serlvet的映射路径仅仅是一个正斜杠</span><span class="o">(/),</span><span class="n">那么这个Servlet就成为当前web应用程序的缺省</span><span class="o">,</span><span class="nc">Servlet</span><span class="err">。</span><span class="n">凡是在web</span><span class="o">.</span><span class="na">xml文件中找不到匹配的</span><span class="o">&lt;</span><span class="nc">Servlet</span><span class="o">-</span><span class="n">mapping</span><span class="o">&gt;</span><span class="n">元素的URL</span><span class="err">。</span>
    <span class="n">它们的访问请求都将交给缺省的Servlet进行处理</span><span class="err">。</span><span class="n">也就是说缺省的Servlet用于处理其他Servlet都不处理的访问请求</span><span class="err">。</span>
<span class="o">&lt;</span><span class="n">servlet</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="nc">ServletDemo2</span><span class="o">&lt;/</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="kd">class</span><span class="err">&gt;</span><span class="nc">gacl</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">study</span><span class="o">.</span><span class="na">ServletDemo2</span><span class="o">&lt;/</span><span class="n">servlet</span><span class="o">-</span><span class="kd">class</span><span class="err">&gt;</span>
     <span class="err">&lt;</span><span class="nc">load</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">startup</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">load</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">startup</span><span class="o">&gt;</span>
<span class="o">/</span><span class="n">servlet</span><span class="o">&gt;</span>

<span class="o">&lt;!--</span> <span class="n">将ServletDemo2配置成缺省Servlet</span> <span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">mapping</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="nc">ServletDemo2</span><span class="o">&lt;/</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">url</span><span class="o">-</span><span class="n">pattern</span><span class="o">&gt;/&lt;/</span><span class="n">url</span><span class="o">-</span><span class="n">pattern</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">servlet</span><span class="o">-</span><span class="n">mapping</span><span class="o">&gt;</span>
</code></pre></div></div><p>####</p><h4 id="urlpattern-的使用注意">UrlPattern 的使用注意</h4><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Web中URL地址的推荐写法</span>
     <span class="n">在JavaWeb开发中</span><span class="err">，</span><span class="n">主要是写URL地址</span><span class="err">，</span><span class="n">那么建议最好是以</span><span class="err">“</span><span class="o">/</span><span class="err">”</span><span class="n">开头</span><span class="err">，</span><span class="n">也就是使用绝对路径的方法</span><span class="err">，</span><span class="n">那么这个</span> <span class="err">“</span><span class="o">/</span><span class="err">”</span><span class="n">到底代表什么呢</span><span class="err">？</span>

<span class="nl">可以使用如下方式来记忆:</span>
  <span class="n">如果是</span><span class="s">"/"</span><span class="n">是给服务器的用的</span><span class="err">，</span><span class="n">则代表当前的WEB工程</span><span class="err">，</span><span class="n">如果</span><span class="err">“</span><span class="o">/</span><span class="err">”</span><span class="n">是给浏览器用的</span><span class="err">，</span><span class="n">则代表webapps目录</span>

<span class="err">"</span><span class="o">/</span><span class="err">”</span><span class="n">代表当前web工程的常见应用场景</span>
</code></pre></div></div><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="err">）</span><span class="nc">ServletContext</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">"/download/1.JPG"</span><span class="o">)</span><span class="n">是用来获取服务器上的某个资源</span><span class="err">，</span><span class="n">那么这个</span><span class="s">"/"</span><span class="n">就是给服务器用的</span><span class="err">。</span>
	<span class="s">"/"</span><span class="n">此时代表的就是整个WEB工程</span> <span class="nc">ServletContext</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">"/download/1.JPG"</span><span class="o">)</span><span class="n">表示的就是读取web工程下的download文件夹中的1</span><span class="o">.</span><span class="na">JPG这个资源</span>
     <span class="o">*</span> <span class="n">只要明白了</span><span class="s">"/"</span><span class="n">代表的具体含义</span><span class="err">，</span><span class="n">就可以很快写出要访问的web资源的绝对路径</span>
	<span class="k">this</span><span class="o">.</span><span class="na">getServeltContext</span><span class="o">().</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">"/download/1.jpg"</span><span class="o">)</span><span class="err">'</span>
<span class="mi">2</span><span class="err">）</span><span class="n">在服务器端forword到其他页面</span>
	<span class="n">forword</span>
	<span class="n">客户端请求某个web资源</span><span class="err">，</span><span class="n">服务器跳转到另外一个web资源</span><span class="err">，</span><span class="n">这个forword也是给服务器用的</span>
	<span class="n">那个这个</span><span class="err">“</span><span class="o">/</span><span class="err">”</span><span class="n">就是给服务器用的</span><span class="o">,</span> <span class="n">所以此时</span><span class="s">"/"</span><span class="n">代表的就是web工程</span>
	<span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getRequestDispatcher</span><span class="o">(</span><span class="s">"/index.jsp"</span><span class="o">).</span><span class="na">forword</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">)</span>
<span class="mi">3</span><span class="err">）</span><span class="n">使用include指令或</span><span class="o">&lt;</span><span class="n">jsp</span><span class="err">：</span><span class="n">include</span><span class="o">&gt;</span><span class="n">标签引入页面</span>
	<span class="o">&lt;%</span><span class="nd">@include</span> <span class="n">file</span><span class="o">=</span><span class="s">"/jspfragments/head.jspf"</span> <span class="o">%&gt;</span>
	<span class="o">&lt;</span><span class="nl">jsp:</span><span class="n">include</span> <span class="n">page</span><span class="o">=</span><span class="s">"/jspfragments/demo.jsp"</span> <span class="o">/&gt;</span>
</code></pre></div></div><blockquote><p><strong><em>”/” 代表 webapps 目录的常见应用场景</em></strong>​</p></blockquote><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;%</span><span class="err">@</span> <span class="n">page</span> <span class="n">language</span><span class="o">=</span><span class="s">"java"</span> <span class="kn">import</span><span class="err">="</span><span class="nn">java.util.*</span><span class="s">" pageEncoding="</span><span class="no">UTF</span><span class="o">-</span><span class="mi">8</span><span class="s">"%&gt;
 &lt;!DOCTYPE HTML PUBLIC "</span><span class="o">-</span><span class="c1">//W3C//DTD HTML 4.01 Transitional//EN"&gt;</span>
 <span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="s">"/"</span><span class="n">代表webapps目录的常见应用场景</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
     <span class="o">&lt;%--</span><span class="n">使用绝对路径的方式引用js脚本</span><span class="o">--%&gt;</span>
     <span class="o">&lt;</span><span class="n">script</span> <span class="n">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="n">src</span><span class="o">=</span><span class="s">"${pageContext.request.contextPath}/js/index.js"</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
     <span class="o">&lt;%--</span><span class="err">$</span><span class="o">{</span><span class="n">pageContext</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">contextPath</span><span class="o">}</span><span class="n">与request</span><span class="o">.</span><span class="na">getContextPath</span><span class="o">()</span><span class="n">写法是得到的效果是一样的</span><span class="o">--%&gt;</span>
     <span class="o">&lt;</span><span class="n">script</span> <span class="n">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="n">src</span><span class="o">=</span><span class="s">"&lt;%=request.getContextPath()%&gt;/js/login.js"</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
     <span class="o">&lt;%--</span><span class="n">使用绝对路径的方式引用css样式</span><span class="o">--%&gt;</span>
      <span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s">"stylesheet"</span> <span class="n">href</span><span class="o">=</span><span class="s">"${pageContext.request.contextPath}/css/index.css"</span> <span class="n">type</span><span class="o">=</span><span class="s">"text/css"</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
       <span class="o">&lt;%--</span><span class="n">form表单提交</span><span class="o">--%&gt;</span>
       <span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span><span class="s">"${pageContext.request.contextPath}/servlet/CheckServlet"</span> <span class="n">method</span><span class="o">=</span><span class="s">"post"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="n">value</span><span class="o">=</span><span class="s">"提交"</span><span class="o">&gt;</span>
          <span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
        <span class="o">&lt;%--</span><span class="n">超链接跳转页面</span><span class="o">--%&gt;</span>
        <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">"${pageContext.request.contextPath}/index.jsp"</span><span class="o">&gt;</span><span class="n">跳转到首页</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>

</code></pre></div></div><blockquote><p><strong><em>${pageContext.request.contextPath}的效果等同于 request.getContextPath()，两者获取到的都是”/项目名称”</em></strong>​</p></blockquote><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="err">）</span> <span class="n">使用sendRedirect实现请求重定向</span>
<span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="s">"/JavaWeb/index.jsp"</span><span class="o">)</span>
<span class="n">服务器发送一个URL地址给浏览器</span><span class="err">，</span><span class="n">浏览器拿到地址之后再去请求服务器</span><span class="err">，</span><span class="n">所以这个</span><span class="s">"/"</span><span class="n">是给浏览器使用的</span><span class="err">。</span><span class="n">此时</span><span class="s">"/"</span><span class="n">代表的是webapps目录</span>
<span class="err">”</span><span class="o">/</span><span class="nc">JavaWeb</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="na">jsp</span><span class="err">“</span><span class="n">这个地址指的就是</span><span class="s">"webapps\JavaWeb\index.jsp"</span>

<span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="s">"/项目名称/文件夹目录/页面"</span><span class="o">)</span>
<span class="n">这种写法是将项目名称写死在程序中的做法</span><span class="err">，</span><span class="n">不灵活</span><span class="err">，</span><span class="n">项目名称变了</span><span class="err">，</span><span class="n">此时就得改程序所以推荐的写法</span><span class="err">：</span>
<span class="n">rfesponse</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getContextPath</span><span class="o">()+</span><span class="s">"/index.jsp"</span><span class="o">);</span>

<span class="n">request</span><span class="o">.</span><span class="na">getContextPath</span><span class="o">()</span><span class="n">获取的内容就是</span><span class="err">”</span><span class="nc">JavaWeb</span><span class="err">“</span><span class="o">,</span><span class="n">这样就比较灵活了</span><span class="err">，</span><span class="n">使用request</span><span class="o">.</span><span class="na">getContext</span><span class="err">（）</span><span class="n">代替项目名称</span><span class="err">，</span><span class="n">推荐使用这种方式</span><span class="err">，</span><span class="n">灵活方便</span>

<span class="mi">2</span><span class="o">)</span><span class="n">使用超链接进行跳转</span>
<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">"/JavaWeb/index.jsp"</span> <span class="o">&gt;</span><span class="n">跳转到首页</span> <span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="n">这是客户端浏览器使用超链接跳转</span><span class="err">，</span><span class="n">这个</span> <span class="s">"/"</span> <span class="n">是给浏览器使用的</span><span class="err">，</span><span class="n">此时</span><span class="s">"/"</span><span class="n">代表的就是webapps目录</span>
<span class="n">使用超链接访问wen资源</span><span class="err">，</span><span class="n">绝对路径的写法推荐使用下面的写法改进</span><span class="err">：</span>
<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">"${pageContext.request.contextPath}/index.jsp"</span><span class="o">&gt;</span><span class="n">跳转到首页</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="n">这样做的好处是</span><span class="err">，</span><span class="n">避免在路径中出现项目的名称</span>


<span class="mi">3</span><span class="o">)</span> <span class="nc">Form表单的提交</span>
<span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span><span class="s">"/JavaWeb/CheckServlet"</span> <span class="n">method</span><span class="o">=</span><span class="s">"post"</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="n">value</span><span class="o">=</span><span class="s">"提交"</span> <span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span><span class="s">"${pageContext.request.contextPath}/servlet/CheckServlet"</span> <span class="n">method</span><span class="o">=</span><span class="s">"post"</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="n">value</span><span class="o">=</span><span class="s">"提交"</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
</code></pre></div></div><p>ccc</p><h3 id="servlet-相关介绍">servlet 相关介绍</h3><h4 id="servlet-缓存技术">servlet 缓存技术</h4><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HTTP协议中关于缓存的关键字包括</span> <span class="nc">Cache</span><span class="o">-</span><span class="nc">Control</span>  <span class="nc">Pragma</span>  <span class="n">last</span><span class="o">-</span><span class="nc">Modified</span>  <span class="nc">Expires</span>

<span class="no">HTTP1</span><span class="o">.</span><span class="mi">0</span> <span class="n">中是通过Param</span> <span class="n">控制页面缓存的</span><span class="err">，</span><span class="n">可以设置</span> <span class="nc">Pragma</span> <span class="n">或no</span><span class="o">-</span><span class="n">cache</span><span class="err">。</span><span class="n">如果让浏览器或中间服务器不进行缓存一般设置no</span><span class="o">-</span><span class="n">cache</span><span class="o">,</span><span class="n">不过这个值不这么保险</span><span class="err">，</span><span class="n">通常加上Expires置为0来达到目的</span>
<span class="n">但如果刻意需要浏览器或中间服务器缓存住我们的页面这个值则需要设置为Pragma</span>

<span class="no">HTTP1</span><span class="o">.</span><span class="mi">1</span><span class="n">中启用Cache</span><span class="o">-</span><span class="nc">Control来控制页面的缓存与否</span><span class="err">，</span><span class="n">常用的参数如下</span><span class="err">：</span>
<span class="n">no</span><span class="o">-</span><span class="n">cache</span>
	<span class="n">浏览器和缓存服务器都不应该缓存页面信息</span>
<span class="kd">public</span>
    <span class="n">浏览器和缓存服务器都可以缓存页面信息</span>
<span class="n">no</span><span class="o">-</span><span class="n">store</span>
	<span class="n">请求和响应的信息都不应该被存储在方法的磁盘系统中</span>
<span class="n">must</span><span class="o">-</span><span class="n">revalidate</span>
	<span class="n">对于客户机的每次请求</span><span class="err">，</span><span class="n">代理服务器必须向服务器验证缓存是否过时</span>
<span class="n">max</span><span class="o">-</span><span class="n">age</span><span class="o">=</span><span class="n">xxx</span> <span class="n">s</span><span class="o">-</span><span class="n">max</span><span class="o">-</span><span class="n">age</span><span class="o">=</span><span class="n">xxx</span>
	<span class="n">替代Expires</span> <span class="n">表示应该在xxx秒后认为页面过时</span><span class="err">，</span><span class="n">后者指示代理服务器中缓存的页面过期时间</span>

<span class="n">通常我们不需要缓存页面时</span>
	<span class="n">setHeader</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span><span class="s">"no-cache,no-store,must-revalidate"</span><span class="o">)</span>
<span class="n">需要缓存页面的时候</span><span class="err">：</span>
	<span class="n">setHeader</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span><span class="s">"public,max-age,s-max-age"</span><span class="o">);</span>

<span class="nc">Last</span><span class="o">-</span><span class="nc">Modified</span>  <span class="n">指页面最后生成时间</span>  <span class="nc">GMT格式</span>
<span class="nc">Expires</span>  <span class="n">过期限制</span><span class="err">，</span><span class="nc">GMT格式</span><span class="err">，</span><span class="n">指浏览器或缓存服务器在该时间点后必须从真正服务器中获取新的页面信息</span>
<span class="nl">注意:</span><span class="n">上面两个值如果是这JSP</span> <span class="n">页面中进行设置需要设置为long型</span>

<span class="c1">//本页面允许在浏览器端或缓存服务器中缓存，时间限制为10秒</span>
    <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Date</span> <span class="n">date</span> <span class="o">=</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Date</span><span class="o">();</span>
    <span class="n">response</span><span class="o">.</span><span class="na">setDateHeader</span><span class="o">(</span><span class="s">"Last-Modified"</span><span class="o">,</span><span class="n">date</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
    <span class="n">response</span><span class="o">.</span><span class="na">setDateHeader</span><span class="o">(</span><span class="s">"Expired"</span><span class="o">,</span><span class="n">date</span><span class="o">.</span><span class="na">getTime</span><span class="o">()+</span><span class="mi">10000</span><span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span><span class="s">"public"</span><span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Pragma"</span><span class="o">,</span><span class="s">"Pragma"</span><span class="o">);</span>

<span class="c1">//不允许浏览器端或缓存服务器缓存当前页面信息</span>
    <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Pragma"</span><span class="o">,</span><span class="s">"no-cache"</span><span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">setDateHeader</span><span class="o">(</span><span class="s">"Expires"</span><span class="o">,</span><span class="s">"0"</span><span class="o">);</span>

    <span class="n">response</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span><span class="s">"no-cache"</span><span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span><span class="s">"no-store"</span><span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span><span class="s">"must-revalidate"</span><span class="o">);</span>
</code></pre></div></div><h4 id="servlet-实例介绍">servlet 实例介绍</h4><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="err">）</span><span class="n">对于不经常变化的数据在Servlet里可以为其设置合理的缓存时间以避免浏览器频繁向服务器发送请求</span>
	<span class="n">设置缓存时间为3分钟</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServlet</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServlet</span> <span class="n">resp</span><span class="o">){</span>
        <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"xxx"</span><span class="err">；</span><span class="o">(</span><span class="n">编码方式和系统的编码方式有关</span><span class="o">)</span><span class="err">；</span><span class="n">详见</span><span class="err">（</span><span class="no">GET</span> <span class="o">&amp;&amp;</span> <span class="nc">POST乱码详解</span><span class="err">）</span>
        <span class="n">resp</span><span class="o">.</span><span class="na">setDataHeader</span><span class="o">(</span><span class="s">"experice"</span><span class="o">,</span><span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()+</span><span class="mi">1000</span><span class="o">*</span><span class="mi">180</span><span class="o">);</span>
        <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">wirter</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>

<span class="mi">2</span><span class="err">）</span> <span class="n">如果要实现中高级功能</span> <span class="n">即客户端请求动态web资源的时候</span><span class="err">，</span>
	<span class="n">动态web资源发现发送给客户端的数据更新了</span><span class="err">，</span><span class="n">就发送给客户端最新的数据</span><span class="err">，</span><span class="n">如果没有更新</span>
	<span class="n">动态web资源就要客户访问的缓存数据</span><span class="err">。</span><span class="n">此种情况可以复写web资源的</span><span class="err">（</span><span class="n">即Servlet</span><span class="err">）</span><span class="n">的getLastModify</span><span class="o">()</span><span class="n">方法实现</span>
        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
              <span class="nc">ServletContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>
              <span class="nc">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span> <span class="s">"annociation.html"</span><span class="o">);</span>
              <span class="nc">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="n">in</span><span class="o">));</span>
              <span class="nc">String</span> <span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
              <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">write</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">//复写service中的getLastModifid()方法</span>
        <span class="kd">protected</span> <span class="kt">long</span> <span class="nf">getLastModified</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">)</span> <span class="o">{</span>
               <span class="c1">//获取文件</span>
              <span class="nc">ServletContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>
              <span class="nc">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span> <span class="s">"/annociation.html"</span><span class="o">);</span>
              <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>

               <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="na">lastModified</span><span class="o">();</span>
       <span class="o">}</span>
</code></pre></div></div><h4 id="servletconfigservletcontext">ServletConfig&amp;&amp;ServletContext</h4><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ServletConfig</span> <span class="n">对象</span>
 <span class="n">在Servelt的配置文件中可以使用一个或多个</span><span class="o">&lt;</span><span class="n">init</span><span class="o">-</span><span class="n">parm</span><span class="o">&gt;</span><span class="n">标签为servlet配置一些初始化参数</span><span class="o">(</span><span class="n">配置在某个servlet标签下或整个web</span><span class="o">-</span><span class="n">app下</span><span class="o">)</span>
 <span class="n">当Servelt配置了初始化参数以后</span><span class="o">,</span><span class="n">web容器在创建servlet实例对象时</span><span class="err">，</span><span class="n">会自动将这些初始化参数封装到ServeltConfig中</span><span class="err">，</span><span class="n">并在调用Servelt的init方法时</span>
 <span class="n">将ServeltConfig对象传递给Servelt</span><span class="err">。</span>

<span class="nc">Servlet中获取ServletConfig</span>
 <span class="mi">1</span><span class="err">）</span> <span class="n">创建一个私有变量</span> <span class="kd">private</span> <span class="nc">ServletConfig</span>  <span class="n">config</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
 <span class="mi">2</span><span class="err">）</span> <span class="n">要重写init</span><span class="o">()</span><span class="n">方法</span><span class="err">，（</span><span class="n">该方法有两个需要重写下面这个</span><span class="err">）</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">ServletConfig</span> <span class="n">config</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span> <span class="o">{</span>
        <span class="c1">// TODO Auto-generated method stub</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">config</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">=</span><span class="n">config</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="mi">3</span><span class="err">）</span><span class="n">获取</span><span class="o">&lt;</span><span class="n">init</span><span class="o">-</span><span class="n">param</span><span class="o">&gt;</span><span class="n">中的配置信息了</span>
    <span class="c1">//获取初始化参数</span>
          <span class="nc">String</span> <span class="n">value1</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"x1"</span><span class="o">);</span>
    <span class="c1">//获取配置文档中的&lt;init-param&gt;标签下name对应的value</span>
          <span class="nc">String</span> <span class="n">value2</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"x2"</span><span class="o">);</span>
     <span class="c1">//获取配置文档中所有的初始化参数使用（Enumeration接受）</span>
           <span class="nc">Enumeration</span> <span class="n">e</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">.</span><span class="na">getInitParameterNames</span><span class="o">();</span>
           <span class="k">while</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hasMoreElements</span><span class="o">()){</span>
                   <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span> <span class="o">)</span> <span class="n">e</span><span class="o">.</span><span class="na">nextElement</span><span class="o">();</span>
                   <span class="nc">String</span> <span class="n">value</span>  <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">"  "</span> <span class="o">+</span> <span class="n">value</span><span class="o">);</span>
          <span class="o">}</span>


<span class="n">在开发中ServletConfig的作用有如下三个</span><span class="err">：</span>
<span class="mi">1</span><span class="o">)</span> <span class="n">获取字符集编码</span>
     <span class="nc">String</span> <span class="n">charset</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"charset"</span><span class="o">);</span>

<span class="mi">2</span><span class="err">）</span><span class="n">获取数据库连接信息</span>
     <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"url"</span><span class="o">);</span>
     <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"username"</span><span class="o">);</span>
     <span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"password"</span><span class="o">);</span>

<span class="mi">3</span><span class="err">）</span><span class="n">获取配置文件</span>
      <span class="nc">String</span> <span class="n">configFile</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"config"</span><span class="o">);</span>

<span class="no">WEB</span><span class="o">.</span><span class="na">xml文件配置在Servlet标签下</span><span class="err">：</span>
      <span class="o">&lt;</span><span class="n">servlet</span> <span class="o">&gt;</span>
               <span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="n">annociation</span><span class="o">&lt;/</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span> <span class="o">&gt;</span>
               <span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="kd">class</span><span class="err">&gt;</span> <span class="nc">Annociation</span><span class="o">&lt;/</span><span class="n">servlet</span><span class="o">-</span><span class="kd">class</span> <span class="err">&gt;</span>
               <span class="err">&lt;</span><span class="nc">init</span><span class="o">-</span><span class="n">param</span><span class="o">&gt;</span>
                      <span class="o">&lt;</span><span class="n">param</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="n">age</span><span class="o">&lt;/</span> <span class="n">param</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
                      <span class="o">&lt;</span><span class="n">param</span><span class="o">-</span><span class="n">value</span><span class="o">&gt;</span> <span class="mi">27</span><span class="o">&lt;/</span> <span class="n">param</span><span class="o">-</span><span class="n">value</span><span class="o">&gt;</span>
               <span class="o">&lt;/</span><span class="n">init</span><span class="o">-</span><span class="n">param</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">servlet</span> <span class="o">&gt;</span>

                   <span class="n">程序中获取</span><span class="err">：</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Annociation</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
     <span class="o">...</span>
     <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
               <span class="c1">// TODO Auto-generated method stub</span>
              <span class="nc">String</span> <span class="n">age</span> <span class="o">=</span> <span class="kd">super</span><span class="o">.</span><span class="na">getServletConfig</span><span class="o">().</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"age"</span> <span class="o">);</span>
              <span class="nc">PrintWriter</span> <span class="n">out</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>
              <span class="n">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">age</span><span class="o">);</span>
              <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"======="</span><span class="o">);</span>
       <span class="o">}</span>
          <span class="o">....</span>
     <span class="o">}</span>
</code></pre></div></div><h5 id="servletcontext-对象">ServletContext 对象</h5><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ServletContext对象</span><span class="err">：</span>
 <span class="nc">WEB容器启动的时候</span><span class="err">，</span><span class="n">它会为每个WEB应用程度都创建一个对应的ServletContext对象</span><span class="err">，</span><span class="n">它代表当前WEB应用</span><span class="err">，</span><span class="nc">ServletConfig对象中维护了ServletContext对象的引用</span><span class="err">。</span>
 <span class="n">可以通过Servletconfig</span><span class="o">.</span><span class="na">getServletContext方法获得ServletContext对象</span><span class="err">。</span>

 <span class="nc">ServletContext对象应用</span>
  <span class="mi">1</span><span class="err">：</span><span class="n">多个WEB组件之间使用它实现数据共享</span>
    <span class="nc">ServletConfig对象中维护了ServletContext对象的引用</span><span class="o">,</span><span class="n">开发人员在编写Servlet时可以通过ServletConfig</span><span class="o">.</span><span class="na">getServletContext方法获取ServletContext的对象</span><span class="err">。</span>
    <span class="n">由于一个WEB应用中的所有Servlet共享同一个ServletContext对象</span><span class="err">，</span><span class="n">因此Servlet对象之间可以通过ServletContext对象来实现通讯</span><span class="err">。</span>
    <span class="nc">ServeltContext对象通常也被称之为context域对象</span>

   <span class="n">在Servlet中可以使用如下语句来设置数据共享</span><span class="err">：</span>
      <span class="nc">ServletContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span><span class="c1">//获取Servlet域对象</span>
      <span class="n">context</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span><span class="s">"数据共享"</span><span class="o">)</span><span class="err">；</span><span class="c1">//设置共享变量</span>
   <span class="n">在另一个Servlet中可以使用如下语句来获取域中的data属性</span>
      <span class="nc">ServletContext</span> <span class="n">context</span> <span class="n">context</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>

   <span class="n">通过serveltContext对象获取整个web应用的配置信息</span>
      <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span> <span class="n">getServeltContext</span><span class="o">().</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"url"</span><span class="o">);</span>
      <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"username"</span><span class="o">);</span>
      <span class="nc">String</span> <span class="n">password</span><span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"password"</span><span class="o">)</span>

  <span class="n">通过servletContext对象实现servlet转发</span>
     <span class="n">由于servlet中的java数据不易设置样式</span><span class="err">，</span><span class="n">所以serlvet可以将java数据转发到JSP页面中进行处理</span>
          <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span><span class="s">"serlvet数据转发"</span><span class="o">);</span>
          <span class="nc">RequestDispatcher</span> <span class="n">rd</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getRequestDispatcher</span><span class="o">(</span><span class="s">"/viewdata.jsp"</span><span class="o">);</span>
          <span class="n">rd</span><span class="o">.</span><span class="na">forward</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>


<span class="n">web</span><span class="o">.</span><span class="na">xml文件中配置</span><span class="err">：</span>
  <span class="o">&lt;</span><span class="n">context</span><span class="o">-</span><span class="n">param</span> <span class="o">&gt;</span>
       <span class="o">&lt;</span><span class="n">param</span><span class="o">-</span><span class="n">name</span> <span class="o">&gt;</span><span class="n">name</span> <span class="o">&lt;/</span><span class="n">param</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
       <span class="o">&lt;</span><span class="n">param</span><span class="o">-</span><span class="n">value</span> <span class="o">&gt;</span><span class="n">shuo</span> <span class="n">ai</span> <span class="n">lin</span><span class="o">&lt;/</span> <span class="n">param</span><span class="o">-</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">context</span><span class="o">-</span><span class="n">param</span> <span class="o">&gt;</span>
<span class="n">在程序中获取的方法</span><span class="err">：</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Annociation</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
     <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
               <span class="c1">// TODO Auto-generated method stub</span>

              <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="kd">super</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getInitParameter</span><span class="o">(</span> <span class="s">"name"</span><span class="o">);</span>
              <span class="n">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span> <span class="n">name</span><span class="o">);</span>
              <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"======="</span><span class="o">);</span>
       <span class="o">}</span>
   <span class="o">}</span>
</code></pre></div></div><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">getServletConfig</span> <span class="n">和</span> <span class="n">getServletContext</span> <span class="n">实在GenericServlet中进行重写的</span><span class="err">，</span><span class="nc">HttpServlet又继承了GenericServlet</span>
<span class="kd">public</span> <span class="nc">ServletConfig</span> <span class="nf">getServletConfig</span><span class="o">()</span>
  <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">config</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nc">ServletContext</span> <span class="nf">getServletContext</span><span class="o">()</span>
  <span class="o">{</span>
    <span class="k">return</span> <span class="nf">getServletConfig</span><span class="o">().</span><span class="na">getServletContext</span><span class="o">();</span>
  <span class="o">}</span>
</code></pre></div></div><h5 id="servletcontext-的使用实例">servletcontext 的使用实例</h5><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="err">）</span> <span class="nc">ServletContext实现请求转发</span>
<span class="o">&lt;!</span><span class="no">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">meta</span> <span class="n">charset</span><span class="o">=</span> <span class="s">"UTF-8"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span> <span class="nc">Insert</span> <span class="n">title</span> <span class="n">here</span><span class="o">&lt;/</span><span class="n">title</span> <span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span> <span class="s">"/Servlet/annociation"</span> <span class="n">method</span> <span class="o">=</span><span class="s">"get"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">input</span>  <span class="n">type</span><span class="o">=</span> <span class="s">"text"</span>  <span class="n">name</span> <span class="o">=</span><span class="s">"test"</span><span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span> <span class="s">"submit"</span> <span class="n">value</span> <span class="o">=</span><span class="s">"提交"</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="kn">package</span> <span class="nn">com.gc</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.PrintWriter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.RequestDispatcher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.ServletException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.annotation.WebServlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletResponse</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"annociation"</span> <span class="o">,</span><span class="n">urlPatterns</span><span class="o">=</span><span class="s">"/annociation/*"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Annociation</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4983121091648494572L</span><span class="o">;</span>
        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
               <span class="c1">// TODO Auto-generated method stub</span>
              <span class="nc">System</span><span class="o">.</span> <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"===============Servlet is running ====================="</span><span class="o">);</span>
              <span class="c1">// 获取ServletConfig对象中的内容</span>
              <span class="nc">String</span> <span class="n">age</span> <span class="o">=</span> <span class="kd">super</span><span class="o">.</span><span class="na">getServletConfig</span><span class="o">().</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"age"</span> <span class="o">);</span>
              <span class="nc">PrintWriter</span> <span class="n">out</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>

              <span class="c1">//通过ServletContext获取ServletContext对象中的内容</span>
              <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="kd">super</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"name"</span> <span class="o">);</span>
              <span class="nc">String</span> <span class="n">ageContext</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"age"</span> <span class="o">);</span>
              <span class="n">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">age</span><span class="o">+</span> <span class="s">"   "</span> <span class="o">+</span><span class="n">name</span><span class="o">);</span>
              <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ageContext</span><span class="o">);</span>
              <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"====================="</span><span class="o">);</span>
               <span class="c1">//获取form表单的元素</span>
              <span class="nc">String</span> <span class="no">ID</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span> <span class="s">"test"</span><span class="o">);</span>
               <span class="k">if</span><span class="o">(</span><span class="no">ID</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"login"</span> <span class="o">)){</span>
                     <span class="err">##</span><span class="n">使用ServletContext进行页面跳转</span>
                     <span class="nc">RequestDispatcher</span> <span class="n">rd</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getRequestDispatcher</span><span class="o">(</span><span class="s">"/web/login"</span><span class="o">);</span>
                     <span class="n">rd</span><span class="o">.</span><span class="na">forward</span><span class="o">(</span><span class="n">req</span><span class="o">,</span> <span class="n">resp</span><span class="o">);</span>
              <span class="o">}</span>

       <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
               <span class="c1">// TODO Auto-generated method stub</span>
               <span class="n">doGet</span><span class="o">(</span><span class="n">req</span><span class="o">,</span> <span class="n">resp</span><span class="o">);</span>
       <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635736641883-2d59abf8-495d-4371-841e-1924e2ec05b1.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=258&amp;id=udabb99d9&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=556&amp;originWidth=1752&amp;originalType=binary&amp;ratio=1&amp;size=314443&amp;status=done&amp;style=none&amp;taskId=ub6f83078-65ec-463f-b5a9-69745322ab0&amp;width=814" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.gc</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.PrintWriter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.ServletException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.annotation.WebServlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletResponse</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"login"</span> <span class="o">,</span> <span class="n">urlPatterns</span><span class="o">=</span><span class="s">"/web/*"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginServlet</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
              <span class="nc">PrintWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>
              <span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span> <span class="s">"test"</span><span class="o">);</span>
              <span class="n">writer</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"=================登陆页面，中文测试=================="</span> <span class="o">);</span>
              <span class="n">writer</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"=================Login page=================="</span> <span class="o">);</span>
              <span class="n">writer</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
       <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
               <span class="c1">// TODO Auto-generated method stub</span>
              <span class="n">doGet</span><span class="o">(</span><span class="n">req</span><span class="o">,</span> <span class="n">resp</span><span class="o">);</span>
       <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><blockquote><p><em>输入”login”页面跳转后的 URL 为</em>​</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635736674165-ebdc29a4-6fa3-48dc-af34-881dcca3cd79.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=65&amp;id=uae4a0f92&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=94&amp;originWidth=1165&amp;originalType=binary&amp;ratio=1&amp;size=11554&amp;status=done&amp;style=none&amp;taskId=u66c57f12-49a3-4e5a-87a5-7681f05ac63&amp;width=802.5" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">发现页面输出乱码</span><span class="err">：</span><span class="n">该乱码是使用POST方式传值时导致的</span><span class="err">，</span>
<span class="nc">POST传值乱码是</span><span class="err">，</span><span class="n">在接受端设置</span><span class="err">：</span>
   <span class="n">request</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span> <span class="s">"UTF-8"</span><span class="o">);</span>
   <span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span> <span class="s">"text/html;charset=utf-8"</span><span class="o">);</span>

<span class="n">使用get方式船只或者URL乱码时</span><span class="err">：</span>
     <span class="k">new</span> <span class="nf">String</span><span class="o">(</span><span class="no">ID</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"ISO-8859-1"</span><span class="o">),</span> <span class="s">"UTF-8"</span><span class="o">);</span>

</code></pre></div></div><h4 id="servlet-跳转">servlet 跳转</h4><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">使用标签</span> <span class="n">meta</span> <span class="n">跳转到对应的Servlet</span>
     <span class="o">&lt;</span> <span class="no">META</span> <span class="no">HTTP</span><span class="o">-</span><span class="no">EQUIV</span><span class="o">=</span> <span class="s">"Refresh"</span> <span class="no">CONTENT</span><span class="o">=</span><span class="s">"0; URL=/Servlet/annociation"</span> <span class="o">/&gt;</span>
</code></pre></div></div><h4 id="servlet-深入解释">Servlet 深入解释</h4><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Servlet</span>
     <span class="nc">Servlet</span> <span class="n">是一个sun公司提供的一门用于开发web资源的技术</span>
     <span class="n">sun公司在其API提供了一个serlvet接口</span><span class="err">，</span><span class="n">用户若想用发一个动态web资源</span><span class="o">(</span><span class="n">即开发一个java程序向浏览器输出数据</span><span class="o">),</span><span class="n">需要完成以下2个步骤</span><span class="err">：</span>
     <span class="mi">1</span><span class="err">）</span> <span class="n">编写一个Java类</span><span class="err">，</span><span class="n">实现servlet接口</span>
     <span class="mi">2</span><span class="err">）</span><span class="n">把开发好的java类部署到web服务器中</span><span class="err">。</span>
     <span class="n">按照一种约定的称呼习惯</span><span class="err">，</span><span class="n">通常我们</span>

<span class="nc">Servlet是一个基于</span> <span class="nc">Java技术的</span> <span class="n">web组件</span><span class="err">，</span><span class="n">运行在服务器端</span><span class="err">，</span><span class="n">由</span> <span class="n">servlet容器管理</span><span class="err">，</span><span class="n">用于生成动态内容</span><span class="err">。</span>
<span class="n">可以说Servlet</span> <span class="n">是子服务器上运行的小程序</span><span class="err">。</span><span class="n">一个</span> <span class="nc">Servlet就是一个</span> <span class="nc">Java类</span> <span class="o">,</span><span class="n">并且可以通过</span> <span class="err">”</span><span class="n">请求</span> <span class="o">-</span><span class="n">响应</span> <span class="err">”</span><span class="n">编程模型来访问的这个驻留在服务器里的</span> <span class="nc">Servlet程序</span>

<span class="mi">1</span><span class="err">）</span> <span class="n">web服务器首先检查是否已经装载并创建了该Servlet的实例对象</span><span class="err">。</span><span class="n">如果是直接执行第4</span><span class="err">）</span><span class="n">步</span><span class="err">，</span><span class="n">否则</span><span class="err">，</span><span class="n">执行第2</span><span class="err">）</span><span class="n">步</span>
<span class="mi">2</span><span class="err">）</span><span class="n">装载并创建该Servlet的一个实例对象</span>
<span class="mi">3</span><span class="err">）</span><span class="n">调用Servlet实例对象的init方法</span>
<span class="mi">4</span><span class="err">）</span><span class="n">创建一个用于封装HTTP请求消息的HTTPServletRequest对象和一个代表HTTP响应的HttpServletResponse对象然后调用Servlet的service方法并将请求对象作为参数传递进去</span>
<span class="mi">5</span><span class="o">)</span> <span class="nc">WEB应用程序被停止或重新启动之前</span><span class="err">，</span><span class="nc">Servlet引擎将卸载Servlet</span><span class="o">,</span><span class="n">并卸载之前调用Servlet的destory</span><span class="o">()</span><span class="n">方法</span><span class="err">、</span>


</code></pre></div></div><h5 id="servlet-的优点">servlet 的优点</h5><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ervlet可以很好地替代公共网关接口</span><span class="o">(</span><span class="nc">Common</span> <span class="nc">Gateway</span> <span class="nc">Interface</span><span class="err">，</span><span class="no">CGI</span><span class="o">)</span><span class="n">脚本</span><span class="err">。</span><span class="n">通常CGI脚本是用Perl或者C语言编写的</span><span class="err">，</span><span class="n">它们总是和特定的服务器平台紧密相关</span><span class="err">。</span>
<span class="n">而servlet是用Java编写的</span><span class="err">，</span><span class="n">所以它们一开始就是平台无关的</span><span class="err">。</span><span class="n">这样</span><span class="err">，</span><span class="nc">Java编写一次就可以在任何平台运行</span><span class="o">(</span><span class="n">write</span> <span class="n">once</span><span class="o">,</span><span class="n">run</span> <span class="n">anywhere</span><span class="o">)</span><span class="n">的承诺就同样可以在服务器上实现了</span><span class="err">。</span><span class="n">servlet还有一些CGI脚本所不具备的独特优点</span><span class="err">：</span>

<span class="mi">1</span><span class="err">、</span><span class="n">servlet是持久的</span><span class="err">。</span><span class="n">servlet只需Web服务器加载一次</span><span class="err">，</span><span class="n">而且可以在不同请求之间保持服务</span><span class="o">(</span><span class="n">例如一次数据库连接</span><span class="o">)</span><span class="err">。</span><span class="n">与之相反</span><span class="err">，</span><span class="nc">CGI脚本是短暂的</span><span class="err">、</span><span class="n">瞬态的</span><span class="err">。</span><span class="n">每一次对CGI脚本的请求</span><span class="err">，</span><span class="n">都会使Web服务器加载并执行该脚本</span><span class="err">。</span><span class="n">一旦这个CGI脚本运行结束</span><span class="err">，</span><span class="n">它就会被从内存中清</span> <span class="n">除</span><span class="err">，</span><span class="n">然后将结果返回到客户端</span><span class="err">。</span><span class="nc">CGI脚本的每一次使用</span><span class="err">，</span><span class="n">都会造成程序初始化过程</span><span class="o">(</span><span class="n">例如连接数据库</span><span class="o">)</span><span class="n">的重复执行</span><span class="err">。</span>
<span class="mi">2</span><span class="err">、</span><span class="n">servlet是与平台无关的</span><span class="err">。</span><span class="n">如前所述</span><span class="err">，</span><span class="n">servlet是用Java编写的</span><span class="err">，</span><span class="n">它自然也继承了Java的平台无关性</span><span class="err">。</span>
<span class="mi">3</span><span class="err">、</span><span class="n">servlet是可扩展的</span><span class="err">。</span><span class="n">由于servlet是用Java编写的</span><span class="err">，</span><span class="n">它就具备了Java所能带来的所有优点</span><span class="err">。</span><span class="nc">Java是健壮的</span><span class="err">、</span><span class="n">面向对象的编程语言</span><span class="err">，</span><span class="n">它很容易扩展以适应你的需求</span><span class="err">。</span><span class="n">servlet自然也具备了这些特征</span><span class="err">。</span>
<span class="mi">4</span><span class="err">、</span><span class="n">servlet是安全的</span><span class="err">。</span><span class="n">从外界调用一个servlet的惟一方法就是通过Web服务器</span><span class="err">。</span><span class="n">这提供了高水平的安全性保障</span><span class="err">，</span><span class="n">尤其是在你的Web服务器有防火墙保护的时候</span><span class="err">。</span>
<span class="mi">5</span><span class="err">、</span><span class="n">setvlet可以在多种多样的客户机上使用</span><span class="err">。</span><span class="n">由于servlet是用Java编写的</span><span class="err">，</span><span class="n">所以你可以很方便地在HTML中使用它们</span><span class="err">，</span><span class="n">就像你使用applet一样</span><span class="err">。</span>

<span class="n">但值得注意的是Servlet并不局限于Web领域</span><span class="o">(</span><span class="n">或者说是HTTP协议相关</span><span class="o">).</span><span class="na">你可能要自己去扩展javax</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">GenericServlet</span> <span class="o">.</span><span class="na">上面第三点就是这个意思</span><span class="o">.</span>
<span class="nl">比如说:</span><span class="n">扩展javax</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">GenericServlet实现一个Servlet</span><span class="o">,</span><span class="n">搞搞电子邮件的smtp</span><span class="o">(</span><span class="nc">Simple</span> <span class="nc">Mail</span> <span class="nc">Transfer</span> <span class="nc">Protocol</span> <span class="n">即简单邮件传输协议</span><span class="o">)</span><span class="n">服务器</span><span class="o">,</span><span class="n">你就是基于SMTP协议扩展了GenericServlet</span> <span class="o">,</span><span class="n">也许你会叫它SMTPServlet</span><span class="o">.</span><span class="na">我们用的HttpServlet不就这个命名规范嘛</span><span class="o">.</span>
<span class="n">综上所述</span><span class="o">,</span><span class="nc">Servlet可以在各种协议下良好的运行应用程序</span><span class="o">.</span>

<span class="n">也许现在很多人不再写Servlet</span><span class="o">,</span><span class="n">但Servlet是心脏</span><span class="o">,</span><span class="nc">Servlet放在刚出世的时候</span><span class="o">,</span><span class="n">还是非常NB的</span><span class="o">.</span><span class="na">到现在</span><span class="o">,</span><span class="n">各种成熟好用的东西很多了</span><span class="o">.</span><span class="na">但不能忘本</span><span class="o">.....</span><span class="na">再深点说</span>  <span class="n">为什么要这么设计</span><span class="err">，</span><span class="n">体现了什么</span><span class="err">？</span><span class="n">我还真是说不上来了</span><span class="o">,</span><span class="n">我觉得上面的几点也已经表明为什么了</span><span class="o">.</span><span class="na">就是Java对协议的一个设计</span><span class="o">.....</span>
<span class="nc">JSP的本质就是Servlet</span><span class="o">,</span><span class="n">或者说</span><span class="o">(</span><span class="n">是吧</span><span class="o">,</span><span class="n">开始说的是java</span><span class="o">,</span><span class="n">汗</span><span class="o">)</span><span class="nc">JavaWeb开发的本质也就是Servlet</span><span class="o">+</span><span class="no">JDBC</span><span class="o">.</span><span class="na">任何性质的框架技术最底层的依然是基于他们2个</span><span class="o">.</span><span class="na">因此如果自己想写一套如SSH那样的框架技术</span><span class="o">,</span><span class="nc">Java最底层的东西是必须掌握的</span><span class="o">.</span>

<span class="nc">Servlet被称为</span><span class="s">"服务器端小程序."</span><span class="n">是运行在服务器端的程序</span><span class="o">,</span><span class="n">用于处理以及响应客户端的请求</span><span class="o">.</span>
</code></pre></div></div><h5 id="servlet-的生命周期"><strong>Servlet 的生命周期</strong></h5><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Servlet的生命周期</span><span class="err">：</span><span class="nc">Servlet加载</span><span class="o">---</span><span class="n">实例化</span><span class="o">---</span><span class="n">服务</span><span class="o">---</span><span class="n">销毁</span>
     <span class="n">init</span><span class="o">()</span><span class="err">：</span>
     	<span class="n">在Servlet的生命周期中进执行一次init</span><span class="err">（）</span><span class="n">方法</span><span class="err">，</span><span class="n">它是在服务器装入Servlet时执行的</span><span class="err">，</span>
     	<span class="n">负责初始化Servlet对象</span><span class="err">，</span><span class="n">以在启动服务器或客户机首次访问Servlet时装入Servlet</span><span class="err">。</span>
        <span class="n">无论有多少客户机访问Serlvet</span><span class="err">，</span><span class="n">都不会重复执行init</span><span class="o">()</span>

     <span class="nc">Service</span><span class="o">():</span>
		<span class="n">它是Servlet的核心</span><span class="err">，</span><span class="n">负责相应客户请求</span><span class="err">，</span><span class="n">每当一个客户请求一个httpServlet对象</span><span class="err">，</span>
        <span class="n">该对象的Service</span><span class="o">()</span><span class="n">方法就要调用</span><span class="err">，</span><span class="n">而且传递给这个方法一个</span><span class="err">“</span><span class="n">请求</span><span class="err">”（</span><span class="nc">ServletRequest对象和一个响应</span><span class="err">“</span><span class="nc">ServletResponse</span><span class="err">”</span><span class="n">对象作为</span>
        <span class="n">参数</span><span class="err">，</span><span class="n">在httpServlet中已存在service</span><span class="err">（）</span><span class="n">方法</span><span class="err">。</span>
        <span class="n">默认的服务功能是调用HTTP请求的方法响应的do功能</span><span class="err">。</span>

     <span class="n">destory</span><span class="o">()</span>
        <span class="n">仅执行一次</span><span class="err">，</span><span class="n">在服务器端停止且卸载servlet时执行该方法</span><span class="err">，</span>
        <span class="n">当Servlet退出生命周期时</span><span class="err">，</span><span class="n">负责释放占用的资源</span><span class="err">。</span>
        <span class="n">一个Servlet在运行service方法时可能会产生其他的线程</span><span class="err">，</span><span class="n">因此调用destory方法时</span><span class="err">，</span><span class="n">这些线程已经终止或完成</span><span class="err">。</span>
</code></pre></div></div><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">javax.servlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">interface</span> <span class="nc">Servlet</span><span class="o">{</span>
  <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">ServletConfig</span> <span class="n">paramServletConfig</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">;</span>
  <span class="kd">public</span> <span class="kd">abstract</span> <span class="nc">ServletConfig</span> <span class="nf">getServletConfig</span><span class="o">();</span>
  <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">service</span><span class="o">(</span><span class="nc">ServletRequest</span> <span class="n">paramServletRequest</span><span class="o">,</span> <span class="nc">ServletResponse</span> <span class="n">paramServletResponse</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span><span class="o">;</span>
  <span class="kd">public</span> <span class="kd">abstract</span> <span class="nc">String</span> <span class="nf">getServletInfo</span><span class="o">();</span>
  <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635736916694-59f389ac-2a5a-460c-95f7-b71c2597ef4c.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=282&amp;id=u5eea644f&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=478&amp;originWidth=1408&amp;originalType=binary&amp;ratio=1&amp;size=126123&amp;status=done&amp;style=none&amp;taskId=ubd9fceb1-824b-4e8c-91d7-db43aeedf07&amp;width=832" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">步骤</span><span class="err">：</span>
  <span class="mi">1</span><span class="err">）</span> <span class="nc">Web</span> <span class="nc">Client</span> <span class="n">向Servlet容器</span><span class="err">（</span><span class="nc">Tomcat</span><span class="err">）</span><span class="n">发出Http请求</span>
  <span class="mi">2</span><span class="err">）</span> <span class="nc">Servlet容器接收Web</span> <span class="nc">Client的请求</span>
  <span class="mi">3</span><span class="err">）</span><span class="nc">Servlet容器创建一个HttpRequest对象</span><span class="err">，</span><span class="n">将Web</span> <span class="nc">Client请求的信息封装到这个对象中</span><span class="err">。</span>
  <span class="mi">4</span><span class="err">）</span><span class="nc">Servlet容器创建一个HttpResponse对象</span>
  <span class="mi">5</span><span class="err">）</span><span class="nc">Servlet容器调用HttpServlet对象的service方法</span><span class="err">，</span><span class="n">把HttpRequest对象与HttpResponse对象作为参数传给</span> <span class="nc">HttpServlet</span> <span class="n">对象</span><span class="err">。</span>
  <span class="mi">6</span><span class="err">）</span><span class="nc">HttpServlet调用HttpRequest对象的有关方法</span><span class="err">，</span><span class="n">获取Http请求信息</span><span class="err">。</span>
  <span class="mi">7</span><span class="err">）</span><span class="nc">HttpServlet调用HttpResponse对象的有关方法</span><span class="err">，</span><span class="n">生成响应数据</span><span class="err">。</span>
  <span class="mi">8</span><span class="err">）</span><span class="nc">Servlet容器把HttpServlet的响应结果传给Web</span> <span class="nc">Client</span><span class="err">。</span>
</code></pre></div></div><h4 id="servlet-工作原理">Servlet 工作原理</h4><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ervlet接受和响应客户请求的过程</span><span class="o">,</span><span class="n">首先客户发送一个请求Servlet是调用service方法对请求进行响应的</span><span class="err">，</span>
<span class="n">通过源代码可见</span><span class="err">，</span><span class="nc">Service方法中对请求进行了匹配</span><span class="err">，</span><span class="n">选择调用doGet和doPost等这些方法</span>
  <span class="n">然后再进入对应的方法中调用逻辑层的方法</span><span class="err">，</span><span class="n">实现对客户的响应</span><span class="err">。</span><span class="n">在servlet接口和GenericServlet中是没有doGet</span><span class="err">（）、</span><span class="n">doPost</span><span class="o">(</span> <span class="o">)</span><span class="n">等这些方法的</span><span class="err">。</span>
<span class="nc">HttpServlet中定义这些方法</span><span class="err">，</span><span class="n">都是返回error信息所以我们每次定义Servlet的方法的时候都必须实现doGet和doPost等这些方法</span>

<span class="n">每一个自定义的Servlet都必须实现Servlet的接口</span><span class="err">，</span><span class="nc">Servlet接口中定义了五个方法</span><span class="err">，</span><span class="n">其中比较重要的三个方法涉及到Servlet的生命周期</span><span class="err">，</span>
	<span class="n">分别是上文提到的init</span><span class="o">(),</span><span class="n">service</span><span class="o">(),</span><span class="n">destroy</span><span class="o">()</span><span class="n">方法</span><span class="err">。</span>
    <span class="nc">GenericServlet是一个通用的</span><span class="err">，</span><span class="n">不特定于任何协议的Servlet</span><span class="o">,</span><span class="n">它实现了Servlet接口</span><span class="err">。</span>
    <span class="n">而HttpServlet继承于GenericServlet</span><span class="err">，</span><span class="n">因此HttpServlet也实现了Servlet接口</span><span class="err">。</span>
    <span class="n">所以我们定义Servlet的时候只需要继承HttpServlet即可</span><span class="err">。</span>

<span class="nc">Servlet接口和GenericServlet是不特定于任何协议的</span><span class="err">，</span><span class="n">而HttpServlet是特定于HTTP协议的类</span><span class="err">，</span>
    <span class="n">所以HttpServlet中实现了service</span><span class="o">()</span><span class="n">方法</span><span class="err">，</span><span class="n">并将请求ServletRequest</span><span class="err">、</span><span class="nc">ServletResponse</span> <span class="n">强转为HttpRequest</span> <span class="n">和</span> <span class="nc">HttpResponse</span><span class="err">。</span>

<span class="n">创建Servlet对象的时机</span><span class="err">：</span>
       <span class="nc">Servlet容器启动时</span><span class="err">，</span><span class="n">读取web</span><span class="o">.</span><span class="na">xml配置文件中的信息</span><span class="err">，</span><span class="n">构造指定的Servlet对象</span><span class="err">，</span><span class="n">创建ServletConfig对象</span><span class="err">，</span><span class="n">通过将ServletConfig对象作为参数来调用Servlet对象的init</span><span class="o">()</span><span class="n">方法</span>
       <span class="n">在Servlet容器启动后</span><span class="err">：</span><span class="n">客户首次向Servlet发出请求</span><span class="err">，</span><span class="nc">Servlet容器会判断内存中是否存在指定的Servlet对象</span><span class="err">，</span><span class="n">如果没有则创建它</span><span class="err">，</span><span class="n">然后根据客户的请求创建HttpRequest</span><span class="err">、</span><span class="nc">HttpResponse对象</span><span class="err">，</span><span class="n">从而调用Servlet</span> <span class="n">对象的service方法</span><span class="err">。</span>
       <span class="nc">Servlet</span> <span class="nc">Servlet容器在启动时自动创建Servlet</span><span class="err">，</span><span class="n">这是由在web</span><span class="o">.</span><span class="na">xml文件中为Servlet设置的</span><span class="o">&lt;</span><span class="n">load</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">startup</span><span class="o">&gt;</span><span class="n">属性决定的</span><span class="err">。</span><span class="n">从中我们也能看到同一个类型的Servlet对象在Servlet容器中以单例的形式存在</span><span class="err">。</span>
       <span class="o">&lt;</span><span class="n">servlet</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="nc">Init</span><span class="o">&lt;/</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="kd">class</span><span class="err">&gt;</span><span class="nc">org</span><span class="o">.</span><span class="na">xl</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">InitServlet</span><span class="o">&lt;/</span><span class="n">servlet</span><span class="o">-</span><span class="kd">class</span><span class="err">&gt;</span>
            <span class="err">&lt;</span><span class="nc">load</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">startup</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">load</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">startup</span><span class="o">&gt;</span>
 		<span class="o">&lt;/</span><span class="n">servlet</span><span class="o">&gt;</span>

</code></pre></div></div><h3 id="web-请求和响应">web 请求和响应</h3><h4 id="中文乱码问题">中文乱码问题</h4><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">乱码的解决方案如下</span><span class="err">：</span>

<span class="n">post</span> <span class="n">传值乱码时</span><span class="o">,</span><span class="n">在接受端设置</span> <span class="n">request</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">)</span><span class="err">，</span>
	<span class="n">最好使用过滤器设置</span><span class="err">，</span><span class="n">并设置response</span><span class="o">.</span><span class="na">setContextType</span><span class="o">(</span><span class="s">"text/html;charset=utf-8"</span><span class="o">);</span>
<span class="n">get传值乱码或者URL乱码时</span><span class="err">，</span><span class="n">手动设置接受的参数</span>
	<span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParamter</span><span class="o">(</span><span class="s">"something"</span><span class="o">).</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"ISO-8859-1"</span><span class="o">),</span><span class="s">"utf-8"</span><span class="o">);</span>
</code></pre></div></div><h5 id="post-方法传值乱码"><strong>post 方法传值乱码</strong></h5><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">由于post方式传值通过request存储的</span><span class="err">，</span><span class="n">在另一个页面也是通过request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span><span class="n">来提取信息</span><span class="err">，</span><span class="n">所以这种情况下乱码主要是</span>
<span class="n">因为request存储信息的编码设置导致的</span><span class="err">。</span>
<span class="n">post提交是</span><span class="err">，</span><span class="n">如果没有设置提交的编码格式</span><span class="err">，</span><span class="n">则会以iso</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="n">方式进行提交</span><span class="err">，</span><span class="n">接受的页面却以utf</span><span class="o">-</span><span class="mi">8</span><span class="n">的方式接受</span><span class="err">。</span>
<span class="n">所以使用如下语句即可得到单个正确的中文字符串</span><span class="err">：</span>
     <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParamter</span><span class="o">(</span><span class="s">"something"</span><span class="o">).</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"ISO-8869-1"</span><span class="o">),</span><span class="s">"UTF-8"</span><span class="o">)</span>
<span class="n">解决方法</span><span class="err">：</span>
     <span class="n">在接受页面设置request</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">)</span><span class="err">。</span>
     <span class="n">最好通过过滤实现每个页面都设置为request</span><span class="o">.</span><span class="na">setcharacterEncoding</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">);</span>
</code></pre></div></div><h5 id="get-方式传值乱码">get 方式传值乱码</h5><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get方式传值有两种</span><span class="err">，</span>
	<span class="n">一种是通过FORM表单get传值</span><span class="err">，</span>
    <span class="n">一个是url地址传值</span><span class="o">(</span><span class="n">实质上这两种方式都是通过url参数方式传值</span><span class="o">)</span>

<span class="n">表单方式get传值</span><span class="err">：</span>
     <span class="n">表单方式get传值编码过程为</span><span class="err">，</span><span class="n">首先浏览器根据页面charset编码方式对传值进行编码</span><span class="err">，</span><span class="n">然后提交至服务器交给tomcat</span><span class="o">,</span><span class="n">tomcat会对这个信息进行编码</span>
     <span class="n">采用的编码方式是server</span><span class="o">.</span><span class="na">xml文件中URIEncoding设置决定的</span><span class="err">，</span><span class="n">也就是说我们使用命令request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"xxx"</span><span class="o">)</span><span class="n">获取表单中参数值时</span><span class="err">，</span><span class="n">得到的字符串</span>
     <span class="n">经过了charset的编码和URIEncoding的编码</span><span class="err">。</span>

     <span class="n">所以只要charset的编码和URIEncoding的解码一致</span><span class="err">，</span><span class="n">并且支持中文</span><span class="err">，</span><span class="n">就能保证没有乱码</span><span class="err">（</span> <span class="nc">Tomcat</span> <span class="n">的URIEncoding的默认编码是iso</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="err">）</span>
     <span class="n">第一种解决方法</span><span class="err">：</span>
     	<span class="n">设置方式修改tomcat的server</span><span class="o">.</span><span class="na">xml的</span> <span class="no">HTTP</span> <span class="nc">Connector或者AJP</span> <span class="nc">Connector的配置上加上URIEncoding</span><span class="o">=</span><span class="s">"utf-8"</span>
                 <span class="o">&lt;</span><span class="nc">Connector</span> <span class="n">connectionTimeout</span><span class="o">=</span> <span class="s">"20000"</span> <span class="n">port</span><span class="o">=</span> <span class="s">"80"</span> <span class="n">protocol</span><span class="o">=</span> <span class="s">"HTTP/1.1"</span> <span class="n">redirectPort</span> <span class="o">=</span><span class="s">"8443"</span> <span class="nc">URIEncoding</span> <span class="o">=</span><span class="s">"utf-8"</span><span class="o">/&gt;</span>

  	<span class="n">第二种解决方法</span><span class="err">：</span>
    	 <span class="n">使用useBodyEncodingForURI</span><span class="o">=</span><span class="s">"true"</span> <span class="n">这个方法合适你的TOMCAT</span> <span class="n">实例下需要多跑不同Encoding的程序时</span>
                  <span class="o">&lt;</span> <span class="nc">Connector</span> <span class="n">connectionTimeout</span> <span class="o">=</span><span class="s">"20000"</span> <span class="n">port</span> <span class="o">=</span><span class="s">"80"</span> <span class="n">protocol</span> <span class="o">=</span><span class="s">"HTTP/1.1"</span> <span class="n">redirectPort</span> <span class="o">=</span><span class="s">"8443"</span> <span class="n">useBodyEncodingForURI</span> <span class="o">=</span><span class="s">"true"</span><span class="o">/&gt;</span>

<span class="n">在Tomcat配置中</span><span class="err">，</span><span class="n">连接器</span><span class="err">（</span><span class="no">HTTP</span> <span class="nc">Connector</span><span class="err">）</span><span class="n">属性中有一个Encoding和useBodyEncodingForURI属性</span><span class="err">，</span>
  <span class="n">这两个属性设置对URL后附加参数进行URL解码时该如何选择字符集编码</span>
  <span class="nc">URIEncoding用于定制URL后的附件参数的字符集编码</span>
  <span class="n">useBodyEncodingForURI则说明是否采用实体内容的字符集编码设置来替代URIEncoding的设置</span><span class="err">，</span><span class="n">也就说useBodyEncodingForURI属性设置为true时</span><span class="err">，</span>
  <span class="nc">ServletRequest</span><span class="o">.</span><span class="na">setCharsetEncoding方法设置的字符集编码也影响了getParameter等方法对URL地址后的参数进行URL解码的结果</span>

 <span class="n">url</span> <span class="n">方式get传值乱码</span>
   <span class="n">对于这种方式</span><span class="err">，</span><span class="n">浏览器不会采用页面的charset方式对URL中的中文进行编码后提交至服务器</span><span class="err">（</span><span class="no">IE</span><span class="err">，</span><span class="nc">FireFox都一样</span><span class="err">）</span><span class="n">而是采用系统的GBK转码为ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="n">之后提交到服务器</span>
   <span class="nc">Tomcat</span><span class="o">,</span><span class="n">所以这个过程为</span><span class="err">：</span>
        <span class="n">首先</span><span class="o">,</span><span class="nc">URL地址中的中文被从GBK转换成ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="n">交给Tomcat后</span><span class="err">，</span>
        	<span class="n">又被tomcat根据URIEncoding解码</span><span class="err">，</span>
            <span class="n">这种情况</span><span class="err">，</span><span class="n">只有把URLEncoding设置为gbk才能在request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">""</span><span class="o">)</span><span class="n">时不出现乱码</span><span class="err">。</span>
  <span class="n">但是这样会影响到上面配置</span><span class="err">，</span><span class="n">所以一个好的解决方法时</span><span class="err">，</span><span class="n">使用java</span><span class="o">.</span><span class="na">net</span><span class="o">.</span><span class="na">URIEncoding对地址中的中文进行手动编码和解码</span>
</code></pre></div></div><h5 id="乱码万全的解决方法">乱码万全的解决方法</h5><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="err">）</span> <span class="n">所有页面的charset设置为UTF</span><span class="o">-</span><span class="mi">8</span><span class="err">。</span>
<span class="mi">2</span><span class="err">）</span> <span class="nc">Tomcat的URIEncoding默认是ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="err">，</span><span class="n">设置为UTF</span><span class="o">-</span><span class="mi">8</span><span class="err">，</span>
      <span class="n">主要是解决中文命名的文件以及请求以get方式提交有可能出现的乱码问题</span><span class="err">。</span>
<span class="mi">3</span><span class="err">）</span> <span class="n">添加过滤器</span><span class="err">，</span><span class="n">调用request</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">)</span><span class="n">方法将request的字符集设定为utf</span><span class="o">-</span><span class="mi">8</span><span class="err">，</span><span class="n">解决请求以post方式提交的乱码问题</span><span class="err">。</span>
<span class="mi">4</span><span class="err">）</span> <span class="n">url地址中存在中文参数时</span><span class="err">，</span><span class="n">首先对中文参数使用URLEcoder编码为utf</span><span class="o">-</span><span class="mi">8</span><span class="err">，</span><span class="n">然后在request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">""</span><span class="o">)</span><span class="n">接收到参数后再使用URLDecoder还原</span><span class="err">。</span>
</code></pre></div></div><h4 id="httpservletrequest">HttpServletRequest</h4><blockquote><p><em>HttpServletRequest 对象代表客户端的请求,当客户端请求通过 HTTP 协议访问服务器时，HTTP 请求头中的所有信息都封装在整个对象中，通过这个对象提供的方法，可以获得客户端请求的所有信息</em></p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635737459606-791ff3e6-53ba-4400-b9be-b447b59a46be.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=438&amp;id=u64b34ca0&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=876&amp;originWidth=1734&amp;originalType=binary&amp;ratio=1&amp;size=911896&amp;status=done&amp;style=none&amp;taskId=u389b0a09-593f-4a2d-a507-65b5f82cdcb&amp;width=867" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">获取客户机信息</span><span class="err">：</span>
        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
               <span class="c1">//得到请求的URL地址</span>
              <span class="nc">String</span> <span class="n">requestUrl</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getRequestURL</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
               <span class="c1">//得到请求的资源</span>
              <span class="nc">String</span> <span class="n">requestUri</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
               <span class="c1">//得到请求的URL地址中附带的参数</span>
              <span class="nc">String</span> <span class="n">queryString</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getQueryString</span><span class="o">();</span>
               <span class="c1">//得到来访者的IP地址</span>
              <span class="nc">String</span> <span class="n">remoteAddr</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getRemoteAddr</span><span class="o">();</span>
              <span class="nc">String</span> <span class="n">remoteHost</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getRemoteHost</span><span class="o">();</span>
               <span class="kt">int</span> <span class="n">remotePort</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getRemotePort</span><span class="o">();</span>
              <span class="nc">String</span> <span class="n">remoteUser</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getRemoteUser</span><span class="o">();</span>
               <span class="c1">//得到请求URL地址时使用的方法</span>
              <span class="nc">String</span> <span class="n">method</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getMethod</span><span class="o">();</span>
              <span class="nc">String</span> <span class="n">pathInfo</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getPathInfo</span><span class="o">();</span>
               <span class="c1">//获取WEB服务器的IP地址</span>
              <span class="nc">String</span> <span class="n">localAddr</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getLocalAddr</span><span class="o">();</span>
               <span class="c1">//获取WEB服务器的主机名</span>
              <span class="nc">String</span> <span class="n">localName</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getLocalName</span><span class="o">();</span>
               <span class="c1">//设置将字符以"UTF-8"编码输出到客户端浏览器</span>
              <span class="n">req</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span> <span class="s">"UTF-8"</span><span class="o">);</span>
               <span class="c1">//通过设置响应头控制浏览器以UTF-8的编码显示数据，如果不加这句话，那么浏览器显示的将是乱码</span>
               <span class="n">resp</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span> <span class="s">"content-type"</span><span class="o">,</span> <span class="s">"text/html;charset=UTF-8"</span> <span class="o">);</span>
               <span class="nc">PrintWriter</span> <span class="n">out</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>
               <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span> <span class="s">"获取到的客户机信息如下："</span> <span class="o">);</span> <span class="o">...</span>

       <span class="o">}</span>

</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635737491404-1e679fee-f9d0-4762-9076-bf97c8f729be.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=163&amp;id=u4f5cc4fb&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=253&amp;originWidth=1169&amp;originalType=binary&amp;ratio=1&amp;size=25596&amp;status=done&amp;style=none&amp;taskId=uab45cfaf-2a5b-4347-b8a3-50a4c03ff91&amp;width=753.5" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">获取请求头的信息</span><span class="err">：</span>

     <span class="n">getHeader</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="n">方法String</span>
     <span class="n">getHeader</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="n">方法Enumeration</span>
     <span class="n">getHeaderNames</span><span class="o">(</span> <span class="o">)</span><span class="n">方法</span>

     <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
              <span class="n">resp</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span> <span class="s">"content-type"</span><span class="o">,</span> <span class="s">"text/html;charset=UTF-8"</span> <span class="o">);</span>
              <span class="nc">PrintWriter</span> <span class="n">out</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>
               <span class="c1">//获取所有请求头</span>
              <span class="nc">Enumeration</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">reqHeadInfos</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getHeaderNames</span><span class="o">();</span>
              <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"获取到的请求头的信息如下："</span> <span class="o">);</span>
              <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span> <span class="s">"&lt;hr/&gt;"</span><span class="o">);</span>
               <span class="k">while</span><span class="o">(</span><span class="n">reqHeadInfos</span><span class="o">.</span><span class="na">hasMoreElements</span><span class="o">()){</span>
                     <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">reqHeadInfos</span><span class="o">.</span><span class="na">nextElement</span><span class="o">();</span>
                      <span class="c1">//获取请求头信息</span>
                     <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getHeader</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
                     <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">name</span><span class="o">+</span> <span class="s">" : "</span><span class="o">+</span><span class="n">value</span><span class="o">);</span>
                     <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span> <span class="s">"&lt;br&gt;"</span><span class="o">);</span>
              <span class="o">}</span>

       <span class="o">}</span>
</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635737523892-51a75c02-3aa7-4fce-b1c0-222b6f86e507.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=132&amp;id=uf14d3f6b&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=184&amp;originWidth=1103&amp;originalType=binary&amp;ratio=1&amp;size=13345&amp;status=done&amp;style=none&amp;taskId=ue2b6240d-e926-4960-9ee6-6a730585cb0&amp;width=790.5" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">获取客户及请求参数</span>
     <span class="n">getParameter</span><span class="o">(</span><span class="nc">String</span> <span class="o">)</span>
     <span class="n">getParameterValues</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span>
     <span class="n">getParameterNames</span><span class="o">()</span><span class="n">方法</span>
     <span class="n">getParamterMap</span><span class="o">()</span><span class="n">方法</span> <span class="o">(</span> <span class="o">)</span>

     <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span> <span class="s">"/Servlet/forminfo"</span> <span class="n">method</span> <span class="o">=</span><span class="s">"post"</span><span class="o">&gt;</span>
        <span class="n">编</span> <span class="o">&amp;</span><span class="n">nbsp</span><span class="o">;&amp;</span><span class="n">nbsp</span><span class="o">;</span><span class="n">号</span><span class="err">：</span><span class="o">&lt;</span> <span class="n">input</span> <span class="n">type</span> <span class="o">=</span><span class="s">"text"</span> <span class="n">name</span><span class="o">=</span><span class="s">"userID"</span> <span class="n">value</span><span class="o">=</span> <span class="s">"NO"</span> <span class="n">size</span> <span class="o">=</span><span class="s">"2"</span> <span class="n">maxlength</span><span class="o">=</span><span class="s">"2"</span> <span class="o">&gt;&lt;</span><span class="n">br</span><span class="o">&gt;</span>
        <span class="n">用户名</span><span class="err">：</span> <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span> <span class="s">"text"</span> <span class="n">name</span> <span class="o">=</span><span class="s">"username"</span> <span class="n">value</span><span class="o">=</span> <span class="s">"请输入用户名"</span> <span class="o">&gt;&lt;</span><span class="n">br</span><span class="o">&gt;</span>
             <span class="n">密码</span><span class="err">：</span> <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span> <span class="s">"password"</span> <span class="n">name</span> <span class="o">=</span><span class="s">"userpass"</span> <span class="n">value</span><span class="o">=</span> <span class="s">"请输入密码"</span> <span class="o">&gt;&lt;</span><span class="n">br</span><span class="o">&gt;</span>

        <span class="n">性</span> <span class="o">&amp;</span><span class="n">nbsp</span><span class="o">;&amp;</span><span class="n">nbsp</span><span class="o">;</span><span class="n">别</span><span class="o">(</span><span class="n">单选框</span><span class="o">)</span><span class="err">：</span>
      <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">"radio"</span> <span class="n">name</span><span class="o">=</span> <span class="s">"sex"</span> <span class="n">value</span> <span class="o">=</span><span class="s">"男"</span> <span class="n">checked</span><span class="o">&gt;</span><span class="n">男</span>
      <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">"radio"</span> <span class="n">name</span><span class="o">=</span> <span class="s">"sex"</span> <span class="n">value</span> <span class="o">=</span><span class="s">"女"</span><span class="o">&gt;</span> <span class="n">女</span><span class="o">&lt;</span> <span class="n">br</span><span class="o">&gt;</span>
          <span class="n">部</span> <span class="o">&amp;</span><span class="n">nbsp</span><span class="o">;&amp;</span><span class="n">nbsp</span><span class="o">;</span><span class="n">门</span><span class="o">(</span><span class="n">下拉框</span><span class="o">)</span><span class="err">：</span>
     <span class="o">&lt;</span><span class="n">select</span> <span class="n">name</span><span class="o">=</span><span class="s">"dept"</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">option</span> <span class="n">value</span><span class="o">=</span> <span class="s">"技术部"</span> <span class="o">&gt;</span><span class="n">技术部</span> <span class="o">&lt;/</span><span class="n">option</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">option</span> <span class="n">value</span><span class="o">=</span> <span class="s">"销售部"</span> <span class="no">SELECTED</span><span class="o">&gt;</span> <span class="n">销售部</span><span class="o">&lt;/</span><span class="n">option</span> <span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">option</span> <span class="n">value</span><span class="o">=</span> <span class="s">"财务部"</span> <span class="o">&gt;</span><span class="n">财务部</span> <span class="o">&lt;/</span><span class="n">option</span><span class="o">&gt;</span>
     <span class="o">&lt;/</span><span class="n">select</span> <span class="o">&gt;&lt;</span><span class="n">br</span><span class="o">&gt;</span>
         <span class="n">兴</span> <span class="o">&amp;</span><span class="n">nbsp</span><span class="o">;&amp;</span><span class="n">nbsp</span><span class="o">;</span><span class="n">趣</span><span class="o">(</span><span class="n">复选框</span><span class="o">)</span><span class="err">：</span>
            <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span> <span class="s">"checkbox"</span> <span class="n">name</span> <span class="o">=</span><span class="s">"inst"</span> <span class="n">value</span><span class="o">=</span><span class="s">"唱歌"</span><span class="o">&gt;</span> <span class="n">唱歌</span>
            <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span> <span class="s">"checkbox"</span> <span class="n">name</span> <span class="o">=</span><span class="s">"inst"</span> <span class="n">value</span><span class="o">=</span><span class="s">"游泳"</span><span class="o">&gt;</span> <span class="n">游泳</span>
            <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span> <span class="s">"checkbox"</span> <span class="n">name</span> <span class="o">=</span><span class="s">"inst"</span> <span class="n">value</span><span class="o">=</span><span class="s">"跳舞"</span><span class="o">&gt;</span> <span class="n">跳舞</span>
            <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span> <span class="s">"checkbox"</span> <span class="n">name</span> <span class="o">=</span><span class="s">"inst"</span> <span class="n">value</span><span class="o">=</span><span class="s">"编程"</span> <span class="n">checked</span><span class="o">&gt;</span><span class="n">编程</span>
            <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span> <span class="s">"checkbox"</span> <span class="n">name</span> <span class="o">=</span><span class="s">"inst"</span> <span class="n">value</span><span class="o">=</span><span class="s">"上网"</span><span class="o">&gt;</span> <span class="n">上网</span>
            <span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;</span>
             <span class="n">说</span> <span class="o">&amp;</span><span class="n">nbsp</span><span class="o">;&amp;</span><span class="n">nbsp</span><span class="o">;</span><span class="n">明</span><span class="o">(</span><span class="n">文本域</span><span class="o">)</span><span class="err">：</span>
           <span class="o">&lt;</span><span class="n">textarea</span> <span class="n">name</span><span class="o">=</span> <span class="s">"note"</span> <span class="n">cols</span> <span class="o">=</span><span class="s">"34"</span> <span class="n">rows</span><span class="o">=</span><span class="s">"5"</span><span class="o">&gt;</span>
             <span class="o">&lt;/</span><span class="n">textarea</span><span class="o">&gt;</span>
           <span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">"hidden"</span> <span class="n">name</span><span class="o">=</span> <span class="s">"hiddenField"</span> <span class="n">value</span> <span class="o">=</span><span class="s">"hiddenvalue"</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="n">value</span><span class="o">=</span> <span class="s">"提交(提交按钮)"</span> <span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">"reset"</span> <span class="n">value</span><span class="o">=</span> <span class="s">"重置(重置按钮)"</span> <span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635737550960-8299b408-5ac0-40ae-a207-b01cff21a46f.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=199&amp;id=u66892a5d&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=258&amp;originWidth=1023&amp;originalType=binary&amp;ratio=1&amp;size=24469&amp;status=done&amp;style=none&amp;taskId=ubb72f11a-1e13-4906-bf7a-45c1a226e7b&amp;width=788.5" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
              <span class="n">req</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span> <span class="s">"utf-8"</span><span class="o">);</span>
               <span class="nc">String</span> <span class="n">html</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
               <span class="nc">String</span> <span class="n">userid</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span> <span class="nf">getParameter</span><span class="o">(</span><span class="s">"userID"</span><span class="o">);</span> <span class="c1">//获取填写的编号</span>
               <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span> <span class="nf">getParameter</span><span class="o">(</span><span class="s">"username"</span><span class="o">);</span> <span class="c1">//获取填写的用户名</span>
               <span class="nc">String</span> <span class="n">userpass</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span> <span class="nf">getParameter</span><span class="o">(</span><span class="s">"userpass"</span><span class="o">);</span> <span class="c1">//获取填写的密码</span>
               <span class="nc">String</span> <span class="n">sex</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span> <span class="nf">getParameter</span><span class="o">(</span><span class="s">"sex"</span><span class="o">);</span> <span class="c1">//获取选中的性别</span>
               <span class="nc">String</span> <span class="n">dept</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span> <span class="nf">getParameter</span><span class="o">(</span><span class="s">"dept"</span><span class="o">);</span> <span class="c1">//获取选中的部门</span>
               <span class="nc">String</span><span class="o">[]</span> <span class="n">insts</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getParameterValues</span><span class="o">(</span> <span class="s">"inst"</span><span class="o">);</span><span class="c1">//获取兴趣</span>
               <span class="nc">String</span> <span class="n">note</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span> <span class="nf">getParameter</span><span class="o">(</span><span class="s">"note"</span><span class="o">);</span> <span class="c1">//获取填写的说明信息</span>
               <span class="nc">String</span> <span class="n">hiddenField</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span> <span class="nf">getParameter</span><span class="o">(</span><span class="s">"hiddenField"</span><span class="o">);</span> <span class="c1">//获取隐藏域的内容</span>
               <span class="nc">String</span> <span class="n">instStr</span><span class="o">=</span> <span class="s">""</span><span class="o">;</span>
               <span class="cm">/**
           * 获取数组数据的技巧，可以避免 insts数组为null时引发的空指针异常错误！
           */</span>
               <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">insts</span><span class="o">!=</span><span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">insts</span><span class="o">.</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
               <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">insts</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                      <span class="n">instStr</span><span class="o">+=</span><span class="n">insts</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
                      <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                            <span class="n">instStr</span><span class="o">+=</span><span class="n">insts</span><span class="o">[</span><span class="n">i</span><span class="o">]+</span> <span class="s">","</span><span class="o">;</span>
                      <span class="o">}</span>
               <span class="o">}</span>
               <span class="n">html</span><span class="o">=</span> <span class="s">"编号："</span><span class="o">+</span><span class="n">userid</span><span class="o">+</span><span class="s">"&lt;br&gt;"</span> <span class="o">+</span><span class="s">"用户名:"</span> <span class="o">+</span><span class="n">username</span><span class="o">+</span><span class="s">"&lt;br&gt;"</span><span class="o">+</span> <span class="s">"密码:"</span><span class="o">+</span><span class="n">userpass</span><span class="o">+</span><span class="s">"&lt;br&gt;"</span> <span class="o">+</span><span class="s">"性别:"</span> <span class="o">+</span><span class="n">sex</span><span class="o">+</span>
                       <span class="s">"&lt;br&gt;"</span><span class="o">+</span><span class="s">"部门:"</span> <span class="o">+</span><span class="n">dept</span><span class="o">+</span><span class="s">"&lt;br&gt;"</span> <span class="o">+</span><span class="s">"兴趣："</span> <span class="o">+</span><span class="n">instStr</span><span class="o">+</span><span class="s">"&lt;br&gt;"</span><span class="o">+</span> <span class="s">"说明信息:"</span> <span class="o">+</span><span class="n">note</span><span class="o">+</span><span class="s">"&lt;br&gt;"</span> <span class="o">+</span><span class="s">"隐藏域"</span> <span class="o">+</span><span class="n">hiddenField</span><span class="o">+</span><span class="s">"&lt;br&gt;"</span><span class="o">;</span>
               <span class="n">resp</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span> <span class="s">"UTF-8"</span><span class="o">);</span><span class="c1">//设置服务器端以UTF-8编码输出数据到客户端</span>
               <span class="n">resp</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span> <span class="s">"text/html;charset=UTF-8"</span><span class="o">);</span><span class="c1">//设置客户端浏览器以UTF-8编码解析数据</span>
               <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">println</span><span class="o">(</span><span class="n">html</span><span class="o">);</span>
       <span class="o">}</span>

</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635737575867-556093ef-f86c-4964-9c9b-4800e3751f0a.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=163&amp;id=u2d4308f3&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=220&amp;originWidth=1068&amp;originalType=binary&amp;ratio=1&amp;size=18683&amp;status=done&amp;style=none&amp;taskId=ubdd41170-f559-4ed2-bc01-304fe7f21ea&amp;width=789" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">服务器端使用getParameterNames方法接受表单参数</span><span class="err">，</span><span class="n">代码如下</span><span class="err">：</span>
          <span class="nc">String</span> <span class="n">html</span><span class="o">=</span><span class="s">""</span><span class="o">;</span>
              <span class="nc">Enumeration</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">paramNames</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getParameterNames</span><span class="o">();</span> <span class="c1">//获取所有的参数名</span>
               <span class="k">while</span><span class="o">(</span><span class="n">paramNames</span><span class="o">.</span><span class="na">hasMoreElements</span><span class="o">()){</span>
                     <span class="nc">String</span> <span class="n">name</span><span class="o">=</span> <span class="n">paramNames</span><span class="o">.</span><span class="na">nextElement</span><span class="o">();</span><span class="c1">//得到参数名</span>
                     <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
                     <span class="n">html</span>  <span class="o">=</span> <span class="n">html</span> <span class="o">+</span> <span class="n">name</span><span class="o">+</span> <span class="s">"  :  "</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="s">"&lt;br&gt;"</span> <span class="o">;</span>
              <span class="o">}</span>
</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635737609964-04b1751e-dd71-4e57-a42b-2064a6231fe7.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=186&amp;id=ufc81d4d0&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=233&amp;originWidth=1025&amp;originalType=binary&amp;ratio=1&amp;size=19536&amp;status=done&amp;style=none&amp;taskId=ue5dfbe96-fa32-414c-a2e2-db473d65a52&amp;width=818.5" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">使用getParameterMap方法接受表单参数</span><span class="err">，</span><span class="n">代码如下</span><span class="err">：</span>
<span class="nc">String</span> <span class="n">html</span><span class="o">=</span><span class="s">""</span><span class="o">;</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">[]&gt;</span> <span class="n">paramMap</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getParameterMap</span><span class="o">();</span>
	<span class="k">for</span><span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">[]&gt;</span> <span class="n">entry</span> <span class="o">:</span><span class="n">paramMap</span><span class="o">.</span><span class="na">entrySet</span><span class="o">()){</span>
        <span class="nc">String</span> <span class="n">paramName</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">paramValue</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">paramValueArr</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">paramValueArr</span><span class="o">!=</span><span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">paramValueArr</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">paramValueArr</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">paramValue</span><span class="o">+=</span><span class="n">paramValueArr</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">paramValue</span><span class="o">+=</span><span class="n">paramValueArr</span><span class="o">[</span><span class="n">i</span><span class="o">]+</span> <span class="s">","</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="o">(</span><span class="nc">MessageFormat</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"&lt;tr&gt;&lt;td&gt;{0}&lt;/td&gt;&lt;td&gt;{1}&lt;/td&gt;&lt;/tr&gt;"</span><span class="o">,</span> <span class="n">paramName</span><span class="o">,</span><span class="n">paramValue</span><span class="o">));</span>
    	<span class="n">html</span><span class="o">=</span><span class="n">html</span><span class="o">+</span><span class="n">data</span><span class="o">;</span>
	<span class="o">}</span>
<span class="n">resp</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span> <span class="s">"UTF-8"</span><span class="o">);</span><span class="c1">//设置服务器端以UTF-8编码输出数据到客户端</span>
<span class="n">resp</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span> <span class="s">"text/html;charset=UTF-8"</span><span class="o">);</span><span class="c1">//设置客户端浏览器以UTF-8编码解析数据</span>
<span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">println</span><span class="o">(</span> <span class="s">"&lt;table&gt;"</span><span class="o">+</span><span class="n">html</span><span class="o">+</span><span class="s">"&lt;/table&gt;"</span> <span class="o">);</span>
</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635737663339-ac2ecfa7-7a6b-4821-b2cf-2905298b990d.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=156&amp;id=u6ad2c1ff&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=194&amp;originWidth=982&amp;originalType=binary&amp;ratio=1&amp;size=17219&amp;status=done&amp;style=none&amp;taskId=u162baf75-7e2c-4a85-b8b0-77560726db8&amp;width=788" alt="image.png" /></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Request对象实现请求转发</span>
  <span class="n">请求转发</span><span class="err">：</span><span class="n">指的是一个web资源收到客户端请求后</span><span class="err">，</span><span class="n">通知服务器去调用另外一个web资源进行处理</span>
<span class="n">在Servlet</span> <span class="n">中实现请求转发有两种方式</span>
<span class="mi">1</span><span class="o">)</span> <span class="n">通过ServletContext的getRequestDispacher</span><span class="o">(</span><span class="nc">String</span> <span class="n">path</span><span class="o">)</span><span class="n">方法</span>
		<span class="n">该方法返回一个RequestDispacher对象</span><span class="err">，</span><span class="n">调用这个对象的forword方法可以实现请求转发</span>
   <span class="nc">RequestDispacher</span> <span class="n">reqDispacher</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getRequestDispatcher</span><span class="o">(</span><span class="s">"/test.jsp"</span><span class="o">);</span>
   <span class="n">reqDispacher</span><span class="o">.</span><span class="na">forword</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">reponse</span><span class="o">)</span>

<span class="mi">2</span><span class="o">)</span> <span class="n">通过request对象提供的getRequestDispacher</span><span class="o">(</span><span class="nc">String</span> <span class="n">path</span><span class="o">)</span><span class="n">方法</span><span class="err">，</span><span class="n">该方法返回一个RequestDispacher对象</span><span class="err">，</span><span class="n">调用这个对象的forword方法可以实现请求转发</span>
   <span class="n">request</span><span class="o">.</span><span class="na">getRequestDispacher</span><span class="o">(</span><span class="s">"/test.jsp"</span><span class="o">).</span><span class="na">forward</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">reponse</span><span class="o">)</span>

<span class="n">request对象同时也是域对象</span><span class="err">（</span><span class="nc">Map容器</span><span class="err">）</span><span class="o">,</span> <span class="n">开发人员通过request对象在实现转发时</span><span class="err">，</span><span class="n">把数据通过request对象带给其他web资源处理</span>

</code></pre></div></div><h4 id="httpservletresponse">HttpServletResponse</h4><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">web服务器接受到客户端的http请求</span><span class="err">，</span><span class="n">会针对每一次请求</span><span class="err">，</span><span class="n">分别创建一个用于代表请求的request对象和代表响应的response对象</span>
<span class="n">request和response对象系带代表请求和响应</span><span class="err">，</span><span class="n">那么我们获取客户及提交过来的数据</span><span class="err">，</span><span class="n">只需要找到request对象就行了</span><span class="err">。</span>
<span class="n">要向客户机输出数据</span><span class="err">，</span><span class="n">只需要找response对象就行了</span>

<span class="nc">HttpServletResponse对象代表服务器的响应</span><span class="err">，</span><span class="n">这个对象中封装了向客户端发送数据</span><span class="err">，</span><span class="n">发送响应头</span><span class="err">，</span><span class="n">发送响应状态码的方法</span><span class="err">。</span>
<span class="nl">对应的一些常用API如下:</span>
</code></pre></div></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/659846/1635737794211-9b377cec-c911-4231-a8ef-da5d8c4a397d.png#clientId=uaafaf5ae-53bd-4&amp;from=paste&amp;height=256&amp;id=ud736dd0f&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=512&amp;originWidth=1764&amp;originalType=binary&amp;ratio=1&amp;size=337882&amp;status=done&amp;style=none&amp;taskId=u84a85763-5883-48dc-9c4f-e7e96608d01&amp;width=882" alt="image.png" /></p><p>** <em>使用 OutputStream 流向客户端浏览器输出中文数据</em>**</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">使用OutPutStream流输出中文注意问题</span><span class="err">：</span>
     <span class="n">在服务器端数据是以哪个码表输出的</span><span class="err">，</span><span class="n">那么就要控制客户端浏览器以相应的码表打开</span><span class="err">，</span><span class="n">比如</span><span class="err">：</span><span class="n">outputStream</span><span class="o">.</span><span class="na">writer</span><span class="o">(</span><span class="s">"中国"</span><span class="err">，</span><span class="s">"utf-8"</span><span class="o">)</span><span class="n">使用outputStream流向客户端浏览器输出中文以UTF</span><span class="o">-</span><span class="mi">8</span><span class="n">进行编码</span><span class="err">。</span><span class="n">此时就要控制客户端浏览器</span>
<span class="n">以UTF</span><span class="o">-</span><span class="mi">8</span><span class="n">的编码打开</span><span class="err">，</span><span class="n">否则显示的时候就会出现中文乱码</span><span class="err">，</span><span class="n">那么在服务器端如何控制客户端的浏览器以utf</span><span class="o">-</span><span class="mi">8</span><span class="n">的编码显示数据呢</span><span class="err">？</span>
<span class="n">就需要通过response设置响应头控制浏览器以utf</span><span class="o">-</span><span class="mi">8</span><span class="n">的编码进行显示</span><span class="err">。</span><span class="n">方法</span><span class="err">：</span> <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"content-type"</span><span class="o">,</span><span class="s">"text/html;charset=UTF-8"</span><span class="o">)</span>

   <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>

       <span class="c1">//Servlet 内部定义的变量的中文编码为GB2312,（该变量与操作系统的环境有关，中文的操作系统编码为GB2312）</span>
       <span class="c1">//前台页面传递的中文参数的编码如果server.xml文件中没有做任何编码配置，则编码为ISO-8859-1</span>
       <span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">"中国"</span><span class="o">;</span>
       <span class="n">resp</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span> <span class="s">"context-type"</span><span class="o">,</span> <span class="s">"text/html;charset=UTF-8"</span> <span class="o">);</span>
       <span class="nc">OutputStream</span> <span class="n">outputStream</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
       <span class="c1">//参照Java 运用章节中的获取字符传编码</span>
       <span class="n">outputStream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span> <span class="n">getEncoding</span><span class="o">(</span><span class="n">data</span><span class="o">).</span><span class="na">getBytes</span><span class="o">());</span>
       <span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">();</span> <span class="c1">//是一个将字符转换为字节数组的过程，这个过程中一定会去查码表，如果是中文的操作系统环境，默认就是GB2312的码表</span>
       <span class="c1">//   将字符转换为字节数组的过程就是讲中文字符转换成GB2312码表上对应的数字</span>
       <span class="kt">byte</span><span class="o">[]</span> <span class="n">datas</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span> <span class="s">"utf-8"</span><span class="o">);</span>
       <span class="c1">//PrintWriter writer = resp.getWriter()</span>
       <span class="c1">// writer.write(data);</span>
       <span class="n">outputStream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">datas</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div><p><strong><em>使用 printWriter 流向客户端浏览器输出中文数据</em></strong></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">使用printwrite需要注意的事项</span><span class="err">：</span> <span class="n">printWriter输出流之前首先使用</span><span class="s">"response.setCharacterEncoding(charset)"</span><span class="n">设置字符串以什么样的编码输出到浏览器</span><span class="err">，</span><span class="n">如</span> <span class="n">response</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">)</span>
     <span class="n">设置将字符以</span><span class="err">“</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="err">”</span><span class="n">编码输出到客户端浏览器</span><span class="err">，</span><span class="n">然后再使用response</span><span class="o">.</span><span class="na">getWriter</span><span class="err">；</span><span class="n">获取PrintWriter进行输出</span><span class="err">。</span><span class="n">这两步骤不能颠倒</span><span class="err">。</span>
   <span class="nd">@Override</span>
   <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
     <span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">"我爱中国"</span> <span class="o">;</span>
     <span class="n">resp</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span> <span class="s">"UTF-8"</span><span class="o">);</span><span class="c1">//设置将字符以"UTF-8"编码输出到客户端浏览器</span>
     <span class="cm">/**
      * PrintWriter out = response.getWriter();这句代码必须放在response.setCharacterEncoding("UTF -8");之后
      * 否则response.setCharacterEncoding("UTF -8")这行代码的设置将无效，浏览器显示的时候还是乱码
      */</span>
     <span class="nc">PrintWriter</span> <span class="n">out</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span> <span class="c1">//获取PrintWriter输出流</span>
     <span class="c1">//out.write("&lt;meta http-equiv ='content-type' content='text/html;charset=UTF-8'/&gt;");</span>
     <span class="n">resp</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span> <span class="s">"content-type"</span><span class="o">,</span> <span class="s">"text/html;charset=UTF-8"</span> <span class="o">);</span>
     <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div><p><strong><em>使用 outputStream 和 printWriter 输出数字</em></strong></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">需要将数字转换为对应的字符</span>
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">outputOneByPrintWriter</span><span class="o">(</span><span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span><span class="o">{</span>
    <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span> <span class="s">"content-type"</span><span class="o">,</span> <span class="s">"text/html;charset=UTF-8"</span> <span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span> <span class="s">"UTF-8"</span><span class="o">);</span>
    <span class="nc">PrintWriter</span> <span class="n">out</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span> <span class="c1">//获取PrintWriter输出流</span>
    <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span> <span class="s">"使用PrintWriter流输出数字1："</span> <span class="o">);</span>
    <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="mi">1</span><span class="o">+</span> <span class="s">""</span><span class="o">);</span>
 <span class="o">}</span>
</code></pre></div></div><p>​</p><p><strong><em>文件下载和注意事项</em></strong></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">使用HttpServletResponse对象实现对文件的下载</span>
<span class="n">文件下载功能的实现思路</span>
<span class="mi">1</span><span class="o">)</span> <span class="n">获取要下载的文件的绝对路径</span>
<span class="mi">2</span><span class="err">）</span><span class="n">获取要下载的文件名</span>
<span class="mi">3</span><span class="err">）</span><span class="n">设置content</span><span class="o">-</span><span class="n">disposition响应头</span> <span class="n">setHeader</span><span class="o">(</span><span class="s">"content-disposition"</span> <span class="o">,</span> <span class="s">"attachment;filename="</span><span class="o">+</span><span class="n">filename</span><span class="o">);</span>
<span class="mi">4</span><span class="err">）</span><span class="n">获取要下载的文件输入流</span><span class="err">，</span><span class="n">创建数据缓冲去</span>
<span class="mi">5</span><span class="err">）</span><span class="n">通过response对象获取OutputStream流</span><span class="err">，</span><span class="n">将FileInputStream流写入到buffer缓冲区</span><span class="err">，</span><span class="n">最后使用OutputStream将缓冲区的数据输出</span>

<span class="n">文件下载几个需要注意的事项</span><span class="err">：</span>
<span class="mi">1</span><span class="err">）</span> <span class="n">中文文件名需要使用URLEncoder</span><span class="o">.</span><span class="na">encode方法进行编码</span><span class="err">，（</span><span class="nc">Encoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">fileName</span><span class="o">,</span><span class="s">"字符编码"</span><span class="o">)</span><span class="err">），</span><span class="n">否则会出现文件名乱名</span>
<span class="mi">2</span><span class="err">）</span> <span class="n">编写文件下载功能时推荐使用OutputStream流</span><span class="err">，</span><span class="n">避免使用PrintWriter流</span><span class="err">，</span><span class="n">因为OutputStream流是字节流</span><span class="err">，</span><span class="n">可以处理任意类型的数据</span><span class="err">，</span><span class="n">而PrintWrite流是字符流</span><span class="err">，</span><span class="n">只能处理字符数据</span><span class="err">，</span>
    <span class="n">如果用字符流处理字节数据</span><span class="err">，</span><span class="n">会导致数据丢失</span><span class="err">。</span>
<span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
    <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="k">try</span><span class="o">{</span>
        <span class="n">downloadFileByOutputStream</span><span class="o">(</span><span class="n">resp</span><span class="o">);</span> <span class="c1">//下载文件，通过OutputStream流</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">void</span> <span class="nf">downloadFileByOutputStream</span><span class="o">(</span><span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
    <span class="c1">//1.获取要下载的文件的绝对路径</span>
    <span class="nc">String</span> <span class="n">realPath</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">"/web/login.html"</span> <span class="o">);</span>
    <span class="c1">//设置content-disposition响应头控制浏览器以下载的形式打开文件，中文文件名要使用URLEncoder.encode方法进行编码，否则会出现文件名乱码</span>
    <span class="nc">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="s">"下载的文件"</span> <span class="o">;</span>
    <span class="n">fileName</span><span class="o">=</span><span class="nc">URLEncoder</span><span class="o">.</span> <span class="nf">encode</span><span class="o">(</span><span class="n">fileName</span><span class="o">,</span><span class="s">"utf-8"</span><span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span> <span class="s">"content-disposition"</span><span class="o">,</span> <span class="s">"attachment;filename="</span> <span class="o">+</span><span class="n">fileName</span><span class="o">);</span>

    <span class="nc">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="n">realPath</span><span class="o">);</span>
    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">];</span>
    <span class="nc">OutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
    <span class="k">while</span> <span class="o">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">buffer</span><span class="o">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//使用OutputStream将缓冲区的数据输出到客户端浏览器</span>
        <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">buffer</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="n">len</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>

</code></pre></div></div><p><strong><em>客户端缓存 Servlet 的输出</em></strong></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">为什么要设置缓存</span>
  <span class="n">一个网站往往会有很多的静态web资源</span><span class="err">，</span><span class="n">例如</span><span class="err">，</span><span class="n">html页面</span><span class="err">、</span><span class="n">css文件</span><span class="err">、</span><span class="n">jpg图片等</span><span class="err">，</span><span class="n">这些资源一旦创建可能永远不会改变</span>
  <span class="n">如果客户端每次访问网站时都下载一次静态web资源</span><span class="err">，</span><span class="n">这样不但会造成服务器的压力增大</span><span class="err">，</span><span class="n">用户的体验也一定不好</span>
  <span class="n">一般来讲</span><span class="err">，</span><span class="n">我们在用户第一次访问网站时</span><span class="err">，</span><span class="n">将静态web资源发给客户</span><span class="err">，</span><span class="n">并通知客户将内容缓存起来</span><span class="err">，</span><span class="n">方便下次访问时使用</span>

<span class="n">缓存的实现方式</span>
     <span class="n">设置合理的缓存时间response</span><span class="o">.</span><span class="na">setDateHeader</span><span class="o">(</span><span class="err">“</span><span class="nc">Expires</span><span class="err">”</span><span class="o">,</span> <span class="n">时间值</span><span class="o">);</span>

<span class="n">不设置缓存的方式</span><span class="err">：</span>
     <span class="n">response</span><span class="o">.</span><span class="na">setDateHeader</span><span class="o">(</span><span class="s">"Expires"</span><span class="o">,-</span><span class="mi">1</span><span class="o">);</span><span class="c1">//IE</span>
     <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span><span class="s">"no-cache"</span><span class="o">);</span>
	 <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Pragma"</span><span class="o">,</span><span class="s">"no-cache"</span><span class="o">);</span>
     <span class="nd">@Override</span>
     <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
         <span class="cm">/**
          * 设置数据合理的缓存时间值，以避免浏览器频繁向服务器发送请求，提升服务器的性能
          * 这里是将数据的缓存时间设置为1天
          */</span>
         <span class="n">resp</span><span class="o">.</span><span class="na">setDateHeader</span><span class="o">(</span> <span class="s">"expires"</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()+</span><span class="mi">1000</span><span class="o">*</span><span class="mi">3600</span><span class="o">*</span><span class="mi">24</span><span class="o">);</span>
         <span class="nc">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">getServletContext</span><span class="o">().</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">"/web/login.html"</span> <span class="o">);</span>
         <span class="nc">OutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
         <span class="kt">int</span> <span class="n">len</span><span class="o">;</span>
         <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">];</span>
         <span class="k">while</span><span class="o">((</span><span class="n">len</span><span class="o">=</span><span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">buf</span><span class="o">))&gt;</span><span class="mi">0</span><span class="o">)</span>
             <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">buf</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">len</span><span class="o">);</span>
     <span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">protected</span> <span class="kt">long</span> <span class="nf">getLastModified</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">)</span> <span class="o">{</span>
   	 	<span class="c1">// 到底该返回什么</span>
    	<span class="c1">// 应该返回文件的最后修改时间</span>
    	<span class="c1">// 1.html 如果修改了就发送，如果没修改发304让用户去拿缓存</span>
    	<span class="nc">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">getServletContext</span><span class="o">().</span><span class="na">getRealPath</span><span class="o">(</span> <span class="s">"/web/login.html"</span><span class="o">);</span>
    	<span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
    	<span class="kt">long</span> <span class="n">lastModified</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">lastModified</span><span class="o">();</span> <span class="c1">// 返回文件的最后修改时间</span>
    	<span class="k">return</span> <span class="n">lastModified</span><span class="o">;</span>
	<span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                      <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
         <span class="n">doGet</span><span class="o">(</span><span class="n">req</span><span class="o">,</span> <span class="n">resp</span><span class="o">);</span>
    <span class="o">}</span>

<span class="n">在HTTPServlet</span> <span class="n">的</span> <span class="n">service方法中</span><span class="err">，</span><span class="n">首先会调用getLastModified方法</span><span class="err">，</span><span class="n">判断返回值是否为</span><span class="o">-</span><span class="mi">1</span>
  <span class="n">从而获知子类是否重写此方法</span>
 	 <span class="n">如果不是</span><span class="o">-</span><span class="mi">1</span><span class="err">，</span><span class="n">说明子类重写了该方法</span><span class="err">，</span><span class="n">此时就会获取浏览器发送过来的</span> <span class="k">if</span><span class="o">-</span><span class="n">modified</span><span class="o">-</span><span class="n">since时间值</span><span class="err">，</span>
     <span class="n">用此时间值和方法的返回值进行比较</span> <span class="n">判断文件是否更新</span><span class="err">，</span><span class="n">如果没有更新就发送304状态码</span><span class="err">，</span><span class="n">让用户去拿缓存</span>
<span class="nc">Servlet</span> <span class="n">中Servie的源代码</span>
 <span class="kd">protected</span>  <span class="kt">void</span> <span class="nf">service</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
                  <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span>
                <span class="o">{</span>
                  <span class="nc">String</span> <span class="n">method</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getMethod</span><span class="o">();</span>

                  <span class="k">if</span> <span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"GET"</span> <span class="o">))</span> <span class="o">{</span>
                    <span class="kt">long</span> <span class="n">lastModified</span> <span class="o">=</span> <span class="n">getLastModified</span><span class="o">(</span><span class="n">req</span><span class="o">);</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">lastModified</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1L</span><span class="o">)</span>
                    <span class="o">{</span>
                      <span class="n">doGet</span><span class="o">(</span><span class="n">req</span><span class="o">,</span> <span class="n">resp</span><span class="o">);</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                      <span class="kt">long</span> <span class="n">ifModifiedSince</span><span class="o">;</span>
                      <span class="k">try</span> <span class="o">{</span>
                        <span class="n">ifModifiedSince</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getDateHeader</span><span class="o">(</span> <span class="s">"If-Modified-Since"</span><span class="o">);</span>
                      <span class="o">}</span>
                      <span class="k">catch</span> <span class="o">(</span><span class="nc">IllegalArgumentException</span> <span class="n">iae</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">ifModifiedSince</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1L</span><span class="o">;</span>
                      <span class="o">}</span>
                      <span class="k">if</span> <span class="o">(</span><span class="n">ifModifiedSince</span> <span class="o">&lt;</span> <span class="n">lastModified</span> <span class="o">/</span> <span class="mi">1000L</span> <span class="o">*</span> <span class="mi">1000L</span><span class="o">)</span>
                      <span class="o">{</span>
                        <span class="n">maybeSetLastModified</span><span class="o">(</span><span class="n">resp</span><span class="o">,</span> <span class="n">lastModified</span><span class="o">);</span>
                        <span class="n">doGet</span><span class="o">(</span><span class="n">req</span><span class="o">,</span> <span class="n">resp</span><span class="o">);</span>
                      <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                        <span class="n">resp</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="mi">304</span><span class="o">);</span>
                      <span class="o">}</span>
                    <span class="o">}</span>
                  <span class="o">}</span>
</code></pre></div></div><h5 id="设置响应头控制浏览器">设置响应头控制浏览器</h5><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HttpServletRespons常见应用</span><span class="err">——</span><span class="n">设置响应头控制浏览器行为</span>

<span class="n">设置Http响应头控制浏览器禁止缓存当前文档内容</span>
<span class="n">response</span><span class="o">.</span><span class="na">setDateHeader</span><span class="o">(</span><span class="s">"expires"</span><span class="o">,-</span><span class="mi">1</span><span class="o">);</span>
<span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span><span class="s">"no-cache"</span><span class="o">)</span>
<span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Pragma"</span><span class="o">,</span><span class="s">"no-cache"</span><span class="o">);</span>

<span class="n">设置Http响应头控制浏览器定时刷新网页</span><span class="err">（</span><span class="no">REFRESH</span><span class="err">）</span>
<span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"refresh"</span><span class="o">,</span><span class="s">"5"</span><span class="o">)</span>  <span class="n">设置refresh响应头控制浏览器每隔5秒钟刷新一次</span>

<span class="n">通过response实现请求重定向</span>
<span class="n">请求重定向指</span><span class="err">：</span>
	<span class="n">一个web资源收到客户端请求后</span><span class="err">，</span><span class="n">通知客户端去访问另一个web资源</span><span class="err">，</span><span class="n">这称之为请求重定向</span>
<span class="n">场景</span><span class="err">：</span>
	<span class="n">用户登录</span><span class="err">，</span><span class="n">用户首先访问登录页面</span><span class="err">，</span><span class="n">登录成功后</span><span class="err">，</span><span class="n">就会跳转到某个页面</span><span class="err">，</span><span class="n">这个过程就是一个请求重定向的过程</span>
<span class="n">实现方式</span><span class="err">：</span>
	<span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="nc">String</span> <span class="n">location</span><span class="o">)</span><span class="err">，</span>
    <span class="n">即调用response对象的sendRedirect方法实现请求重电箱</span>

<span class="n">sendRedirect内部实现的原理</span><span class="err">：</span><span class="n">使用response设置302状态码和设置location响应头实现重定向</span>
</code></pre></div></div><div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"><h3>文档信息</h3><ul><li>本文作者：<a href="http://localhost:4000" target="_blank">ssgao</a></li><li>本文链接：<a href="http://localhost:4000/2014/10/01/WEB&Servlet/" target="_blank">http://localhost:4000/2014/10/01/WEB&Servlet/</a></li><li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">创意共享3.0许可证</a>）</li></ul></div></article><div class="share"></div><div class="comment"><div id="gitalk-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/vendor/gitalk/gitalk.css"> <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> <script> var gitalk = new Gitalk({ id: '/2014/10/01/WEB&Servlet/', clientID: 'd2e1cbbd298958076462', clientSecret: 'b42a4178e5fd4a7cf63189ef4b1453b05c375709', repo: 'blog-comments', owner: 'mzlogin', admin: ['mzlogin'], labels: ['gitment'], perPage: 50, }); gitalk.render('gitalk-container'); </script></div></div><div class="column one-fourth"><h3>Search</h3><div id="site_search"> <input style="width:96%" type="text" id="search_box" placeholder="Search"></div><ul id="search_results" style="font-size:14px;list-style-type:none;padding-top:10px;padding-left:10px;"></ul><script src="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/js/simple-jekyll-search.min.js"></script> <script type="text/javascript"> SimpleJekyllSearch({ searchInput: document.getElementById('search_box'), resultsContainer: document.getElementById('search_results'), json: 'http://localhost:4000/assets/search_data.json?v=1636615429', searchResultTemplate: '<li><a href="{url}" title="{title}">{title}</a></li>', noResultsText: 'No results found', limit: 10, fuzzy: false, exclude: ['Welcome'] }) </script><h3 class="post-directory-title mobile-hidden">Table of Contents</h3><div id="post-directory-module" class="mobile-hidden"><section class="post-directory"><dl></dl></section></div><script src="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/js/jquery.toc.js"></script></div></div></section><style> .videoWrapper { position: relative; padding-bottom: 56.333%; height: 0; background: black; } .videoWrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }</style><script> function get_youtube_id(url) { var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/; return (url.match(p)) ? RegExp.$1 : false; } function vimeo_embed(url,el) { var id = false; $.ajax({ url: 'https://vimeo.com/api/oembed.json?url='+url, async: true, success: function(response) { if(response.video_id) { id = response.video_id; if(url.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0; if(url.indexOf('loop=1') !== -1) var loop=1; else var loop=0; var theInnerHTML = '<div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+id+'/?byline=0&title=0&portrait=0'; if(autoplay==1) theInnerHTML += '&autoplay=1'; if(loop==1) theInnerHTML += '&loop=1'; theInnerHTML += '" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>'; el.innerHTML = theInnerHTML; } } }); } function video_embed() { var p = document.getElementsByTagName('p'); for(var i = 0; i < p.length; i++) { //check if this is an external url (that starts with https:// or http:// if (p[i].innerHTML.indexOf("http://") == 0 || p[i].innerHTML.indexOf("https://") == 0) { var youtube_id = get_youtube_id(p[i].innerHTML); if(youtube_id) { if(p[i].innerHTML.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0; if(p[i].innerHTML.indexOf('loop=1') !== -1) var loop=1; else var loop=0; var theInnerHTML = '<div class="videoWrapper"><iframe width="720" height="420" src="https://www.youtube.com/embed/' + youtube_id + '?rel=0&showinfo=0'; if(autoplay==1) theInnerHTML += '&autoplay=1'; if(loop==1) theInnerHTML += '&loop=1&playlist='+youtube_id+'&version=3'; if(p[i].innerHTML.indexOf('start=') !== -1) theInnerHTML += '&start='+p[i].innerHTML.substring(p[i].innerHTML.indexOf('start=')+6); theInnerHTML += '" frameborder="0" allowfullscreen></iframe></div>'; p[i].innerHTML = theInnerHTML; } if(p[i].innerHTML.indexOf('vimeo.com') !== -1) { //ask vimeo for the id and place the embed vimeo_embed(p[i].innerHTML,p[i]); } } } } video_embed(); function mp3_embed() { var p = document.getElementsByTagName('p'); for(var i = 0; i < p.length; i++) { if(p[i].innerHTML.indexOf('.mp3') !== -1) { var str = p[i].innerHTML.split('?'); if(str.length == 1) str[1] = ''; var str1 = str[1]; str1 = str1.replace('&','').replace('&',''); str1 = str1.replace('autoplay=1','').replace('autoplay=0',''); str1 = str1.replace('loop=1','').replace('loop=0',''); str1 = str1.replace('controls=0','').replace('controls=1',''); if (str[0].lastIndexOf('.mp3', str[0].length - 4) === str[0].length - 4 && str1.length == 0) { if(str[1].indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0; if(str[1].indexOf('loop=1') !== -1) var loop=1; else var loop=0; if(str[1].indexOf('controls=0') !== -1) var controls=0; else var controls=1; var newInnerHTML = '<audio'; if(autoplay==1) newInnerHTML += ' autoplay'; if(loop==1) newInnerHTML += ' loop'; if(controls==1) newInnerHTML += ' controls'; newInnerHTML += '><source src="'+str[0]+'" type="audio/mpeg">Your browser does not support the audio element.</audio>'; p[i].innerHTML = newInnerHTML; } } } } mp3_embed(); </script><footer class="container"><div class="site-footer" role="contentinfo"><div class="copyright left mobile-block"> © 2015 <span title="ssgao">ssgao</span> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a></div><ul class="site-footer-links right mobile-hidden"><li> <a href="javascript:window.scrollTo(0,0)" >TOP</a></li></ul><a href="https://github.com/aouoxx/aouoxx.github.io" target="_blank" aria-label="view source code"> <span class="mega-octicon octicon-mark-github" title="GitHub"></span> </a><ul class="site-footer-links mobile-hidden"><li> <a href="http://localhost:4000/" title="首页" target="">首页</a></li><li> <a href="http://localhost:4000/categories/" title="分类" target="">分类</a></li><li> <a href="http://localhost:4000/links/" title="链接" target="">链接</a></li><li> <a href="http://localhost:4000/about/" title="关于" target="">关于</a></li><li><a href="http://localhost:4000/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a></li></ul></div></footer><div class="tools-wrapper"> <a class="gotop" href="#" title="回到顶部"><span class="octicon octicon-arrow-up"></span></a></div><script src="https://cdn.jsdelivr.net/gh/aouoxx/aouoxx.github.io@master/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script><div style="display:none"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-80669434-1', 'auto'); ga('send', 'pageview'); </script></div></body></html>
